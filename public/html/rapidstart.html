<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
		"http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head><script type="text/javascript" src="http://localhost:5555?[]&amp;_=0.791626340476796"></script>
	<title>Rapid Start</title>

	<link rel="shortcut icon" href="../documentjs/jmvcdoc/images/favicon.ico">
	<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxx-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<style type="text/css">.floatLeft {
  float: left;
}
/* content types */
body {
  font-family: sans-serif, "Trebuchet MS", Verdana, Helvetica, Arial;
  margin: 20px 0px 0px 0px;
  background: #fcfcfc;
  font-size: 17px;
}
h1 {
  position: relative;
  margin: 0;
}
h1 span.subtitle {
  color: #888888;
  font-style: italic;
}
h2 {
  border-bottom: solid 1px	#C3E2EF;
  padding-bottom: 3px;
}
h3 {
  color: #96A84A;
  font-size: 1.3em;
  margin-bottom: 10px;
}
h5 {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
pre {
  background-color: #F9F7DF;
  border: solid 1px white;
  margin: 13px 0;
  padding: 13px;
}
dl {
  margin: 10px;
}
td {
  padding: 3px;
  vertical-align: top;
}
.error {
  border: solid 1px red;
}
.error_text {
  color: red;
  font-size: 10px;
}
/* LAYOUT =========================*/
#documentation {
  width: 1024px;
  margin: 0px auto;
}
#top {
  margin: 0 20px 20px 20px;
  padding: 10px 0;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  background: #004634;
  background: -webkit-gradient(linear, left bottom, left top, color-stop(0, #004634), color-stop(1, #01654a));
  background: -ms-linear-gradient(bottom, #004634, #01654a);
  background: -moz-linear-gradient(center bottom, #004634 0%, #01654a 100%);
  background: -o-linear-gradient(bottom, #004634 0%, #01654a 100%);
  background: linear-gradient(bottom, #004634 0%, #01654a 100%);
  /*filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#01654a', endColorstr='#004634',GradientType=0 ); /* IE6-9 */

  -webkit-box-shadow: 0px 1px 0px #ffffff;
  -moz-box-shadow: 0px 1px 0px #ffffff;
  box-shadow: 0px 1px 0px #ffffff;
}
#top .content {
  /*height:34px;*/

  margin: 0 10px;
  overflow: auto;
}
#top #searchRoundCorners {
  float: left;
  width: 293px;
  height: 15px;
  padding: 0px;
  margin: 0px;
  zoom: 1;
  display: inline;
  padding-top: 5px;
}
#top #search {
  width: 273px;
  font-size: 14px;
  font-family: "Trebuchet MS", Verdana, Helvetica, Arial, sans-serif;
  float: left;
  border: none;
  background: #FFFFFF;
  outline: none;
  margin-left: 10px;
  position: absolute;
  margin: 0 0 0 10px;
  padding: 3px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border: 1px solid #004634;
  -webkit-box-shadow: 0px 1px 0px #0f8563;
  -moz-box-shadow: 0px 1px 0px #0f8563;
  box-shadow: 0px 1px 0px #0f8563;
}
#top .logo-text a {
  color: white;
  float: right;
  left: -8px;
  position: relative;
  top: -4px;
  text-decoration: none;
  border: none;
}
#top .logo-image {
  left: 4px;
  position: relative;
  top: 8px;
  border: none;
}
/* TOP MENU STYLE ===== */
#defaults {
  float: left;
  font-weight: bold;
  width: 400px;
  margin-left: 10px;
  margin-bottom: 1px;
  height: 35px;
  line-height: 35px;
}
#defaults a {
  color: white;
  /*padding: 0px 10px;*/

  margin: 0 1px;
  text-decoration: none;
}
#defaults .ui-menu {
  height: 25px;
  line-height: 25px;
  margin: 7px 0px;
  padding: 0px;
  list-style-image: none;
  list-style-position: outside;
  list-style-type: none;
  position: absolute;
  z-index: 1000;
}
#defaults .ui-menu-item {
  float: left;
  /*padding:0.5em 1em;*/

  cursor: pointer;
}
#defaults .menuLink, #defaults .menuSpan {
  display: inline;
  height: 25px;
  float: left;
  cursor: pointer;
  font-size: 16px;
  text-shadow: 0px -1px #000000;
}
#defaults .menuSpan {
  padding-left: 10px;
  padding-right: 10px;
}
#defaults .menuLink:hover .menuSpan, #defaults .menuLink:hover span.red {
  background-color: #899d09;
  color: white;
  border-radius: 3px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  text-shadow: 0px 1px #333;
  -webkit-box-shadow: 0px 1px 0px #003f2f;
  -moz-box-shadow: 0px 1px 0px #003f2f;
  box-shadow: 0px 1px 0px #003f2f;
}
html*#searchRoundCorners {
  /* ie7 hack */

  padding: 7px;
}
.inside td {
  vertical-align: middle;
}
#bottom {
  margin: 0px 20px;
  clear: both;
}
#bottom p, #bottom ul, #bottom ol {
  color: #333;
  line-height: 24px;
}
#bottom a {
  color: #1f54c6;
}
#bottom p code {
  border: solid 1px #F9F7DF;
  white-space: nowrap;
  background-color: #eeeeee;
}
#bottom h2 code, #bottom h3 code {
  font-size: 17px;
  font-weight: normal;
  color: #333333;
  border: solid 1px #F9F7DF;
  background-color: #f9f9f9;
}
#nav {
  width: 300px;
  min-height: 10px;
  float: left;
  /*background-color: #2D2E26;*/
  /*#B8B495*/

  /*background-color:rgb(239,242,213);*/

  overflow: auto;
  margin-right: 20px;
  margin-bottom: 20px;
}
#nav a {
  display: block;
  padding: 5px;
  text-decoration: none;
  font-size: 14px;
  /*color: #F1F1C3;*/

  color: #404038;
  border: none;
  outline: none;
}
#nav #selected {
  margin: 0 0 10px 0;
}
#nav #selected .selected {
  font-size: 17px;
  font-weight: bold;
}
#nav #selected .spacer {
  height: 10px;
  background: #fcfcfc;
}
#nav #selected .content {
  margin: 0 0px;
  clear: both;
}
#nav #selected .content a {
  padding: 5px 10px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  background-color: #d2d988;
}
#nav #selected .content .highlight {
  background-color: #d7e1ad;
}
#nav #results {
  /*margin:10px 0 0 0;*/

  background-color: #e6f1ba;
  padding: 5px 0;
}
#nav #results .highlight {
  /*background-color: #3C3D32;*/

  background-color: #b6dceb;
}
#nav #results .open {
  /*the opened color*/

  background: #a0b348;
  color: white;
  font-weight: bold;
}
#nav .faded {
  color: gray;
}
#nav .prototype, #nav .static {
  color: gray;
}
#nav .class, #nav .constructor {
  font-weight: bold;
}
#nav .attribute {
  color: red;
}
#doc_container {
  margin-right: 0px;
  margin-left: 320px;
}
#doc {
  /*line-height:24px;*/

  /*padding: 0 20px 0 0;*/

  margin: 0;
}
#doc .type {
  color: gray;
  font-size: 0.8em;
}
#doc .content .type, #doc .typeEnd {
  text-shadow: none;
  display: inline-block;
  font-size: 0.7em;
  color: #FFFFFF;
  background: url("file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/type.png") no-repeat;
  background-position: 0 0;
  vertical-align: middle;
  margin-left: -9px;
  margin-bottom: 3px;
  *margin-bottom: 0px;
  /* ie7 */

}
#doc .typeEnd {
  display: block;
  line-height: 21px;
  background-position: 100% 0;
  margin-left: 11px;
  padding: 0 10px 0 5px;
  float: left;
}
#doc .top {
  margin: 0 0 20px;
  line-height: 38px;
  background-color: #c3e2ef;
  padding: 5px 0 1px 0;
  text-shadow: 0px 1px white;
  color: #222;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
}
#doc .top .content {
  margin: 5px 20px 5px 20px;
}
#doc .favorite {
  float: right;
  cursor: pointer;
  background-repeat: no-repeat;
  /*background-position: left 16px;*/

  /* ie7 hacks */

  *position: absolute;
  top: 5px;
  right: 0;
}
#doc .favoriteon {
  background-image: url(file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/fav-on.png);
}
#doc .favoriteoff {
  background-image: url(file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/fav-off.png);
}
#disqus_thread {
  margin: 0;
}
.remove {
  float: right;
  display: block;
  width: 16px;
  text-align: center;
  height: 16px;
  background-image: url('file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/sidebar_top_close.png');
  margin: 1px -4px 0 0;
  opacity: 0.5;
}
.remove :hover {
  opacity: 1;
}
.jmvcdoc_search {
  position: relative;
}
.jmvcdoc_search .remove {
  display: none;
  position: absolute;
  top: 3px;
  right: 11px;
}
#low {
  font-size: 12px;
  margin: 10px auto;
  text-align: center;
  color: white;
  background: #e0e0e0;
  height: 30px;
  line-height: 30px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  clear: both;
  width: 1024px;
}
#low a {
  color: #666;
  text-decoration: none;
  font-weight: bold;
}
/* CONTENT FORMATTING ============= */
.param, .return {
  text-indent: -48px;
  margin-left: 48px;
}
.param *, .return * {
  text-indent: 0px;
}
.param label, .return label {
  color: #808080;
  font-size: 10pt;
  font-weight: bold;
  margin: 0;
}
.options {
  margin-left: 40px;
  margin-right: 40px;
  text-align: left;
}
.options th {
  border-bottom: 1px solid #EEEEEE;
  font-family: "Helvetica Neue", Arial, sans-serif;
  font-size: 0.8em;
}
.options td {
  border-bottom: 1px solid #EEEEEE;
  font-size: 10pt;
  line-height: 150%;
  padding: 3px;
  vertical-align: top;
}
.signiture {
  border-color: #9C6854;
  background: none;
  background-color: white;
}
.params {
  margin-left: 13px;
}
code .comment {
  color: #007000;
}
.string {
  color: Gray;
}
.keyword {
  color: #800080;
}
code .params {
  color: blue;
  margin: 0px;
}
.magic {
  background-color: #FFF7D7;
}
.console {
  color: blue;
}
.this {
  color: #0000C0;
}
table pre {
  margin: 0px;
}
.floatLeft {
  float: left;
}
h2.spaced {
  clear: left;
  padding-top: 18px;
}
.warn {
  margin: 13px;
  padding: 13px;
  font-size: 11px;
  border: 1px solid #9C6854;
  background-color: #eeeeee;
}
.tip {
  font-size: 0.8em;
  font-family: verdana;
  padding-left: 13px;
}
.noborder {
  border: none;
}
.floatLeft .noborder {
  padding-right: 10px;
}
iframe {
  display: block;
  clear: right;
  width: 100%;
  border: 1px solid #cccccc;
  padding: 0 0 10px 10px;
  margin: 10px 0 10px 0;
  background-color: #eeeeee;
}
.iframe_wrapper {
  border: 1px solid #ffffff;
}
.iframe_menu_button {
  display: block;
  float: right;
  width: 100px;
  background-color: #cccccc;
  border-top: 1px solid #999999;
  border-left: 1px solid #999999;
  border-right: 1px solid #999999;
  cursor: pointer;
}
.iframe_menu {
  list-style-image: none;
  list-style-position: outside;
  list-style-type: none;
  font-size: 0.7em;
  background-color: #ffffff;
  border: 1px solid #999999;
  padding: 5px;
  margin: 0;
}
.iframe_menu_item {
  margin: 5px 2px 0px 2px;
}
/* @demo css
-------------*/
.demo .reset {
  padding: 0;
  margin: 0;
  border: 0;
  outline: 0;
  line-height: 1.3;
  text-decoration: none;
  font-size: 100%;
  list-style: none;
}
.demo .header a {
  font-family: "Trebuchet MS", Verdana, Helvetica, Arial, sans-serif;
  font-size: 12px;
  /*background-color: #AABF54;*/

  background-color: #D2D988;
  display: block;
  padding: .5em .5em .5em 2.2em;
  margin: 0;
  color: #FFFFFF;
  cursor: pointer;
  position: relative;
  margin-top: 1px;
  zoom: 1;
  /*border: 1px solid #AABF54;*/

  border: 1px solid #D2D988;
  text-decoration: none;
}
.demo .header .ui-icon {
  position: absolute;
  left: .5em;
  top: 50%;
  margin-top: -8px;
}
.demo .content {
  border: 1px solid #AABF54;
}
.demo .content iframe {
  padding: 0;
  margin: 0;
  background-color: #FFFFFF;
  border: none;
}
.demo pre {
  padding: 10px;
  margin: 0px;
  background-image: none;
}
.demo pre code {
  font-family: "Courier New";
  border: none;
}
.component {
  margin-right: 12px;
  height: 80px;
  float: left;
}
.whisper {
  color: #96A84A;
}
/* menu items */
iframe.pluginify {
  border: none;
  background: none;
  margin: 0px;
  height: 2060px;
  padding: 0px;
}
#tooltip {
  background-color: #b6dceb;
  height: 16px;
  padding: 5px;
  border-top: solid 5px white;
  border-bottom: solid 5px white;
  border-right: solid 5px white;
}
</style></head><body>
<div id="documentation">
	<div id="top">
		<div class="content">
			<div id="searchRoundCorners">
				<div class="jmvcdoc_search"><input id="search" type="input"><span title="clear term" class="remove"></span></div>
			</div>
			<div id="defaults">
				<ul id="menu" class="ui-menu">
					<li class="ui-menu-item">
						<a class="menuLink" href="#favorites"><span class="menuSpan">Favorites</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../follow.html" title="Follow"><span class="menuSpan red">Follow</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../contribute.html" title="Contribute"><span class="menuSpan red">Contribute</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../code.html" title="Code"><span class="menuSpan red">Code</span></a>
					</li>
				</ul>
			</div>
			<div class="logo-text"><a href="http://javascriptmvc.com"><img src="../documentjs/jmvcdoc/images/logo80x30.png" class="logo-image"></a></div>
		</div>
	</div>
	<div id="bottom">
		<div id="nav" class="jmvcdoc_nav">


	<div id="selected">
		    
				
		<div class="content">
			    <a href="#!" class="selected choice page" style="padding-left: 20px">
			    	
					JavaScriptMVC
					
				</a>
				
		</div>
			
				<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!tutorials" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Tutorials
					
				</a>
				
		</div>
			
			
	</div>

<div id="results" style="display: block">
	<div class="content">
	    
			
		    <a href="#!installing" class="result choice page" style="padding-left: 20px" data-name="installing">
		    	
					<span class="faded"></span>Installing JavaScriptMVC
				
			</a>
			
		
			
		    <a href="#!rapidstart" class="result choice page open" style="padding-left: 20px" data-name="rapidstart">
		    	
					<span class="faded"></span>Rapid Start
				
			</a>
			
		
			
		    <a href="#!getstarted" class="result choice page" style="padding-left: 20px" data-name="getstarted">
		    	
					<span class="faded"></span>Get Started with JavaScriptMVC
				
			</a>
			
		
			
		    <a href="#!mvc" class="result choice page" style="padding-left: 20px" data-name="mvc">
		    	
					<span class="faded"></span>Get Started with jQueryMX
				
			</a>
			
		
			
		    <a href="#!tutorials.steal" class="result choice page" style="padding-left: 20px" data-name="tutorials.steal">
		    	
					<span class="faded"></span>Get Started With StealJS
				
			</a>
			
		
			
		    <a href="#!funcunit.getstarted" class="result choice page" style="padding-left: 20px" data-name="funcunit.getstarted">
		    	
					<span class="faded"></span>Get Started with FuncUnit
				
			</a>
			
		
			
		    <a href="#!organizing" class="result choice page" style="padding-left: 20px" data-name="organizing">
		    	
					<span class="faded"></span>Organizing Your App
				
			</a>
			
		
			
		    <a href="#!ajaxy" class="result choice page" style="padding-left: 20px" data-name="ajaxy">
		    	
					<span class="faded"></span>Searchable Ajax Apps
				
			</a>
			
		
			
		    <a href="#!services" class="result choice page" style="padding-left: 20px" data-name="services">
		    	
					<span class="faded"></span>Ajax Service Guidelines
				
			</a>
			
		
			
		    <a href="#!migrate" class="result choice page" style="padding-left: 20px" data-name="migrate">
		    	
					<span class="faded"></span>Upgrading to 3.2
				
			</a>
			
		
	</div>
</div>


</div>
		<div id="doc_container">
			<div id="doc" class="jmvcdoc_content">
<div class="top">
	<div class="content">
	    <h1>Rapid Start&nbsp;
	    	<span class="page type"><span class="typeEnd">page</span></span>&nbsp;
	    	<span class="favorite favoriteoff">&nbsp;&nbsp;&nbsp;</span></h1>
	    
	    
	    
		
		
		
	</div>	
</div>


<p>This walks through the basics of JavaScriptMVC by building a 
smal todo app.  Check out the <a href="#!getstarted">Getting Started Guide</a> 
for a more in-depth overview.</p>

<h2>Get JavaScriptMVC</h2>

<p><a href="http://javascriptmvc.com/builder.html">Download it</a> or 
<a href="#!developwithgit">pull it from Git</a>.  JavaScriptMVC (JMVC) is a collection of 4 sub-projects. 
Once you have JavaScriptMVC, you should have a folder with:</p>

<pre><code class=" javascript">documentjs - documentation engine
funcunit   - testing app
jquery     - jquery and jQueryMX plugins
steal      - dependency management
js         - JS command line <span class="keyword">for</span> Linux/Mac
js.bat     - JS command line <span class="keyword">for</span> Windows
</code></pre>

<p><b>Notice</b>: This folder, the one that has the sub-projects, is 
called the <a href="#!rootfolder">ROOT FOLDER</a>.</p>

<h2>Get JavaScriptMVC running.</h2>

<p>JMVC uses <a href="#!steal">steal/steal.js</a> for dependency 
management. Steal loads scripts.  To use JavaScriptMVC's 
features like <a href="#!jQuery.Controller">$.Controller</a> and <a href="#!jQuery.View">$.View</a>,
'steal' them like:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/controller'</span>,<span class="string">'jquery/view/ejs'</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
   <span class="comment">//code that uses controller and view goes here</span>
})
</code></pre>

<p>To use steal, you need to add the steal script to 
your page. In the <a href="#!rootfolder">root folder</a> create a <strong>todos</strong> folder
and empty <strong>todos.html</strong> and <strong>todos.js</strong> that look like:</p>

<pre><code class=" javascript">ROOT\
    documentjs\
    jquery\
    funcunit\
    steal\
    todos\
      todos.js
      todos.html
</code></pre>

<p>To load <em>steal.js</em> and <em>todos.js</em>, make <strong>todos.html</strong> look like:</p>

<pre><code class=" javascript">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
  &lt;ul id=<span class="string">'todos'</span>&gt;&lt;/ul&gt;
  &lt;input id=<span class="string">'editor'</span>/&gt;
  &lt;script type=<span class="string">'text/javascript'</span>
          src=<span class="string">'../steal/steal.js?todos/todos.js'</span>&gt;
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Open the page in your browser.  Use a debugger like firebug to see <em>steal.js</em> and
<em>todos.js</em> loading.</p>

<h2>steal <code>steal([paths])</code></h2>

<p><a href="#!steal">steal</a> is used to load scripts, styles, even CoffeeScript, LESS
and templates into your application.  </p>

<p>Path are assumed to be relative to the <a href="#!rootfolder">root folder</a>. This
means that the following always loads <code>jquery/class/class.js</code>
no matter which file is calling steal:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class/class.js'</span>);
</code></pre>

<p>You can load relative to the current file by adding <code>./</code> to the
start of your path like:</p>

<pre><code class=" javascript">steal(<span class="string">'./helpers.js'</span>)
</code></pre>

<p>Steal also supports css, allowing you to steal <code>todos/todos.css</code> 
like:</p>

<pre><code class=" javascript">steal(<span class="string">'./todos.css'</span>)
</code></pre>

<p>Because loading paths like <code>jquery/class/class.js</code> is so 
common, if you do not provide an extension like <code>.js</code>, steal 
will append the last folder name and <code>.js</code>. This makes
the following load <code>jquery/class/class.js</code>:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>)
</code></pre>

<p>Steal is an asynchronous loader, so you can't do:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>)
$.Class
</code></pre>

<p>Instead, do:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  $.Class
})
</code></pre>

<p>For this application, we will load jQueryMX's most
common plugins.  Add the following to <strong>todos.js</strong>:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>,
      <span class="string">'jquery/model'</span>,
      <span class="string">'jquery/dom/fixture'</span>,
      <span class="string">'jquery/view/ejs'</span>,
      <span class="string">'jquery/controller'</span>,
      <span class="string">'jquery/controller/route'</span>,
      <span class="function"><span class="keyword">function</span><span class="params">($)</span>{</span>

})
</code></pre>

<p>The following goes through each plugin while we build the todos app.</p>

<h2>$.Class <code>$.Class([name,] [classProps,] [prototypeProps])</code></h2>

<p>Constructors made with <a href="#!jQuery.Class">$.Class</a> are used to create
objects with shared properties. It's used by both
<strong>$.Controller</strong> and <strong>$.Model</strong>.</p>

<p>To create a <strong>Class</strong> of your own, call <strong>$.Class</strong> with the:</p>

<ul>
<li><strong>name</strong> of the class which can be used for introspection,</li>
<li><strong>classProperties</strong> that are attached directly to the constructor, and</li>
<li>instance <strong>prototypeProperties</strong>.</li>
</ul>

<p><strong>$.Class</strong> sets up the prototype chain so subclasses can be further 
extended and sub-classed as far as you like:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>

  $.Class(<span class="string">"Todo"</span>,{
    init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>},

    author : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> ... },

    coordinates : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span> ... },

    allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span> 
     <span class="keyword">return</span> <span class="literal">true</span>;
    }
  });

  Todo(<span class="string">'PrivateTodo'</span>,{
    allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span>
      <span class="keyword">return</span> account.owns(<span class="keyword">this</span>);
    }
  })

});
</code></pre>

<p><em>Brief aside on <code>super</code>.  $.Class provides a 
<code>_super</code> method to call the function of the same name higher 
on the prototype chain like:</em></p>

<pre><code class=" javascript"><span class="keyword">var</span> SecureNote = Todo({
  allowedToEdit: <span class="function"><span class="keyword">function</span><span class="params">(account)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>._super(account) &amp;&amp; 
       <span class="keyword">this</span>.isSecure();
  }
})
</code></pre>

<h3>constructor / init <code>new Class(arg1, arg2)</code></h3>

<p>When a class constructor is invoked, <strong>$.Class</strong> creates the instance and 
calls <a href="#!jQuery.Class.prototype.init">$.Class.prototype.init</a> with 
the arguments passed to <code>new Class(...)</code>.</p>

<pre><code class=" javascript">$.Class(<span class="string">'Todo'</span>,{
  init : <span class="function"><span class="keyword">function</span><span class="params">(text)</span> {</span>
    <span class="keyword">this</span>.text = text
  },
  read : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    console.log(<span class="keyword">this</span>.text);
  }
})

<span class="keyword">var</span> todo = <span class="keyword">new</span> Todo(<span class="string">"Hello World"</span>);
todo.read()
</code></pre>

<p><em>Brief aside on <strong>init</strong>.  $.Class actually calls 
<a href="#!jQuery.Class.prototype.setup">$.Class.prototype.setup</a> before 
init.  <code>setup</code> can be used to change (or normalize) the arguments passed to <strong>init</strong>.</em></p>

<h2>Model <code>$.Model(name, classProperties, prototypeProperties)</code></h2>

<p>Models are central to any application.  They 
contain data and logic surrounding it.  You 
extend <a href="#!jQuery.Model">$.Model</a> with your domain specific 
methods and $.Model provides a set of methods 
for managing changes.</p>

<p>To create a <strong>Model</strong> class, call <strong>$.Model</strong> with the:</p>

<ul>
<li><strong>name</strong> of the class,</li>
<li><strong>classProperties</strong>, including 
<a href="#!jQuery.Model.static.findAll">findAll</a>,
<a href="#!jQuery.Model.static.findAll">findOne</a>,
<a href="#!jQuery.Model.static.create">create</a>,
<a href="#!jQuery.Model.static.update">update</a>,
<a href="#!jQuery.Model.static.destroy">destroy</a> properties, and</li>
<li>prototype instance properties.</li>
</ul>

<p>Make a Todo model in <strong>todos.js</strong> like the following:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/class'</span>,
      <span class="string">'jquery/controller'</span>,
      <span class="string">'jquery/model'</span>,
      <span class="string">'jquery/view/ejs'</span>,
      <span class="string">'jquery/dom/fixture'</span>,
      <span class="function"><span class="keyword">function</span><span class="params">($)</span>{</span>

  $.Model(<span class="string">'Todo'</span>,{
    findAll : <span class="string">"GET /todos"</span>,
    findOne : <span class="string">"GET /todos/{id}"</span>,
    create  : <span class="string">"POST /todos"</span>,
    update  : <span class="string">"PUT /todos/{id}"</span>,
    destroy : <span class="string">"DELETE /todos/{id}"</span>
  },
  {})
});
</code></pre>

<p><strong>Note:</strong> Try the following commands in your browser:</p>

<h3>new $.Model(attributes)</h3>

<p>Create a todo instance like:</p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"do the dishes"</span>});
</code></pre>

<h3>attr <code>model.attr( name, [value] )</code></h3>

<p><a href="#!jQuery.Model.prototype.attr">$.Model.prototype.attr</a> reads or sets properties on model instances.</p>

<pre><code class=" javascript">todo.attr(<span class="string">'name'</span>) <span class="comment">//-&gt; "do the dishes"</span>

todo.attr(<span class="string">'name'</span>, <span class="string">"wash the dishes"</span> );

todo.attr() <span class="comment">//-&gt; {name: "wash the dishes"}</span>

todo.attr({name: <span class="string">"did the dishes"</span>});
</code></pre>

<h3>Talking to the server</h3>

<p>Model uses static <a href="#!jQuery.Model.static.findAll">findAll</a>,
<a href="#!jQuery.Model.static.findAll">findOne</a>, <a href="#!jQuery.Model.static.create">create</a>,
<a href="#!jQuery.Model.static.update">update</a>, and <a href="#!jQuery.Model.static.destroy">destroy</a>
methods to create, read, update and delete 
model instances on the server.  </p>

<p>Now you can call methods on Todo that
make changes on the server.  For example, 
in your console, try:</p>

<pre><code class=" javascript">Todo.findAll({});
</code></pre>

<p>In the console, you'll see it make a request 
to <code>GET /todos</code>.</p>

<p>Assuming your server does not have a <code>/todos</code> service,
this won't work.  That's ok, we can simulate them with
<a href="#!$.fixture">$.fixture</a>.</p>

<h3>$.fixture <code>$.fixture(url, fixture(original, settings, headers) )</code></h3>

<p>Fixtures simulate requests to a specific 
url.  The <code>fixture</code> function is called with:</p>

<ul>
<li><strong>original</strong> - original settings passed to $.ajax</li>
<li><strong>settings</strong> - settings normalized by $.ajax</li>
<li><strong>headers</strong> - request headers</li>
</ul>

<p>And, it's expected to return an array of the arguments
passed to jQuery's ajaxTransport <code>completeCallback</code> system:</p>

<pre><code class=" javascript"><span class="keyword">return</span> [ status, statusText, responses, responseHeaders ];
</code></pre>

<p>This might look like:</p>

<pre><code class=" javascript"><span class="keyword">return</span> [ <span class="number">200</span>, <span class="string">"success"</span>, {json: []}, {} ];
</code></pre>

<p>If the array only has one item, it's assumed to be the json
data.  </p>

<p>To simulate the todo services, add the following within the
steal callback:</p>

<pre><code class=" javascript"><span class="comment">// our list of todos</span>
<span class="keyword">var</span> TODOS = [
    {id: <span class="number">1</span>, name: <span class="string">"wake up"</span>},
    {id: <span class="number">2</span>, name: <span class="string">"take out trash"</span>},
    {id: <span class="number">3</span>, name: <span class="string">"do dishes"</span>}
];
<span class="comment">// findAll</span>
$.fixture(<span class="string">"GET /todos"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  <span class="keyword">return</span> [TODOS]
});

<span class="comment">// findOne</span>
$.fixture(<span class="string">"GET /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">(orig)</span>{</span>
  <span class="keyword">return</span> TODOS[(+orig.data.id)-<span class="number">1</span>];
})

<span class="comment">// create</span>
<span class="keyword">var</span> id= <span class="number">4</span>;
$.fixture(<span class="string">"POST /todos"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  <span class="keyword">return</span> {id: (id++)}
})

<span class="comment">// update</span>
$.fixture(<span class="string">"PUT /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  <span class="keyword">return</span> {};
})

<span class="comment">// destroy</span>
$.fixture(<span class="string">"DELETE /todos/{id}"</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  <span class="keyword">return</span> {};
})
</code></pre>

<p>Now you can use Model's ajax methods to CRUD todos.</p>

<h3>findAll <code>findAll( params, success( todos ), error() )</code></h3>

<p><a href="#!jQuery.Model.static.findAll">findAll</a> retrieves multiple todos:</p>

<pre><code class=" javascript">Todo.findAll({}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span> {</span>
  console.log( todos );
})
</code></pre>

<h3>findOne <code>findOne( params, success( todo ), error() )</code></h3>

<p><a href="#!jQuery.Model.static.findOne">findOne</a> retrieves a single todo:</p>

<pre><code class=" javascript">Todo.findOne({}, <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>
  console.log( todo );
})
</code></pre>

<h3>save <code>todo.save( success( todo ), error() )</code></h3>

<p><a href="#!jQuery.Model.prototype.save">Save</a> can <strong>create</strong> 
or <strong>update</strong> instances depending if the 
instance has already been created or not.</p>

<p>To <strong>create</strong> a todo on the server, create a
todo instance and call <strong>save</strong> like the following:</p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>})
todo.save(<span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>
  console.log( todo );
})
</code></pre>

<p>To <strong>update</strong> a todo on the server, change the attributes
and call <strong>save</strong> again like the following:</p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});
todo.save( <span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>
  console.log(<span class="string">"created"</span>, todo );

  todo.attr(<span class="string">"name"</span>, <span class="string">"mow my lawn"</span>)
  todo.save( <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>
    console.log(<span class="string">"updated"</span>, todo );
  })
})
</code></pre>

<h3>destroy <code>todo.destroy( success( todo ), error() )</code></h3>

<p><a href="#!jQuery.Model.prototype.destroy">Destroy</a> deletes a 
record on the server.  You can do this like:</p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});
todo.save( <span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>
  console.log(<span class="string">"created"</span>, todo );

  todo.destroy( <span class="function"><span class="keyword">function</span><span class="params">( todo )</span> {</span>
    console.log(<span class="string">"destroyed"</span>, todo );
  })
})
</code></pre>

<h3>bind <code>todo.bind( event, handler(ev, todo ) )</code></h3>

<p>Listening to changes in the Model is what MVC 
is about.  Model lets you <a href="#!jQuery.Model.prototype.bind">bind</a> to changes 
on an individual instance 
or <a href="#!jQuery.Model.static.bind">all instances</a>. For example, you can listen to 
when an instance is <strong>created</strong> on the server like:</p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todo({name: <span class="string">"mow lawn"</span>});
todo.bind(<span class="string">'created'</span>, <span class="function"><span class="keyword">function</span><span class="params">(ev, todo)</span>{</span>
  console.log(<span class="string">"created"</span>, todo );
})
todo.save()
</code></pre>

<p>You can listen to anytime an <strong>instance</strong> is created on the server by 
binding on the model:</p>

<pre><code class=" javascript">Todo.bind(<span class="string">'created'</span>, <span class="function"><span class="keyword">function</span><span class="params">(ev, todo)</span>{</span>
  console.log(<span class="string">"created"</span>, todo );
})
</code></pre>

<p>Model produces the following events on 
the model class and instances whenever a model Ajax request completes:</p>

<ul>
<li><strong>created</strong> - an instance is created on the server</li>
<li><strong>updated</strong> - an instance is updated on the server</li>
<li><strong>destroyed</strong> - an instance is destroyed on the server</li>
</ul>

<h3>$.fn.model <code>$(el).model([modelInstance])</code></h3>

<p>It can be helpful to label an element with a model instance
so it can be retrieved later. <a href="#!jQuery.fn.model">jQuery.fn.model</a> is used
to get and set a model instance on an element.</p>

<p>To set an instance:</p>

<pre><code class=" javascript"><span class="keyword">var</span> li = $(<span class="string">'&lt;li&gt;'</span>).model( <span class="keyword">new</span> Todo({id: <span class="number">5</span>}) )
                  .appendTo(<span class="string">"#todos"</span>);
</code></pre>

<p>This will add <strong>'todo todo_5'</strong> to the <code>&lt;li&gt;</code>'s className. We can
get back the model instance with:</p>

<pre><code class=" javascript">li.model().id <span class="comment">//-&gt; 5</span>
</code></pre>

<h3>elements <code>todo.elements( [context] )</code></h3>

<p><a href="#!jQuery.Model.prototype.elements">Elements</a> retrieves the elements that 
have a model instance. A <strong>context</strong> element (or query string) can be 
provided to limit the search to within a particular element:</p>

<pre><code class=" javascript">todo.elements(<span class="string">'#todos'</span>);
</code></pre>

<h2>View <code>$.View( idOrUrl, data )</code></h2>

<p><a href="#!jQuery.View">$.View</a> is used to easily create HTML with
JS templates. Pass it ...</p>

<ul>
<li>the <strong>id</strong> of a script tag to use as the content of the template</li>
<li><strong>data</strong> to pass to the template</li>
</ul>

<p>... and it returns the rendered result of the template.  For
example, add the following to <strong>todos.html</strong>:</p>

<pre><code class=" javascript">&lt;script type=<span class="string">'text/ejs'</span> id=<span class="string">'todosEJS'</span>&gt;
  &lt;% <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++ ){ %&gt;
    &lt;li&gt;&lt;%= <span class="keyword">this</span>[i].name %&gt;&lt;/li&gt;
  &lt;% } %&gt;
&lt;/script&gt;
</code></pre>

<p>Render a list of todos with:</p>

<pre><code class=" javascript"> Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>
     console.log( $.View( <span class="string">'todosEJS'</span>, todos ) );
 });
</code></pre>

<p>$.View also takes a <strong>url</strong> for a template location.  <strong>Create</strong> 
a <em>todos/todos.ejs</em> file that contains the following:</p>

<pre><code class=" javascript">&lt;% <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.length; i++ ){ %&gt;
  &lt;li&gt;&lt;%= <span class="keyword">this</span>[i].name %&gt;&lt;/li&gt;
&lt;% } %&gt;
</code></pre>

<p>Render this with:</p>

<pre><code class=" javascript">Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>
  console.log( $.View( <span class="string">'todos.ejs'</span>, todos ) );
});
</code></pre>

<p><strong>$.View</strong> works with any template language, such
as JAML, jQuery-tmpl, Mustache and superpowers them with:</p>

<ul>
<li>Loading from scripts and external files </li>
<li>using templates with jQuery <strong>modifiers</strong> like html</li>
<li>Template caching</li>
<li>Deferred support</li>
<li>Bundling processed templates in production builds</li>
</ul>

<h3>Modifiers - <code>el.<i>modifier</i>( idOrUrl, data )</code></h3>

<p><strong>$.View</strong> overwrites the jQuery's html modifiers
after, append, before, html, prepend, replaceWith, and text,
allowing you to write:</p>

<pre><code class=" javascript">Todo.findAll( {}, <span class="function"><span class="keyword">function</span><span class="params">( todos )</span>{</span>
  $(<span class="string">'#todos'</span>).html( <span class="string">'todos.ejs'</span>, todos );
});
</code></pre>

<p>To make this work, make sure <code>todos.html</code> has a <code>#todos</code> element like:</p>

<pre><code class=" javascript">&lt;ul id=<span class="string">'todos'</span>&gt;&lt;/ul&gt;
</code></pre>

<h3>Deferreds</h3>

<p><strong>$.Model</strong>'s ajax methods return a deffered. <strong>$.View</strong>
accepts deferreds, making this hotness possible:</p>

<pre><code class=" javascript">$(<span class="string">'#todos'</span>).html(<span class="string">'todos.ejs'</span>, Todo.findAll() )
</code></pre>

<p>This syntax will render todos.ejs with the todo instances in the AJAX request 
made by Todo.findAll, whenever its completed.</p>

<h3>Hookup <code>&lt;li &lt;%= (el)-&gt; CODE %&gt; &gt;</code></h3>

<p><a href="#!jQuery.View.hookup">$.View.hookup</a> lets you provide 
<a href="http://wiki.ecmascript.org/doku.php?id=strawman:arrow&lt;em&gt;function&lt;/em&gt;syntax">ES5-style arrow function</a> 
callbacks on elements in your template.  These callback functions
get called after the template has been 
inserted into the DOM. You can call jQuery methods on the element like:</p>

<pre><code class=" javascript">&lt;li &lt;%= ($el) -&gt; $el.fadeIn() %&gt; style=<span class="string">'display:none'</span>&gt;
  &lt;%= <span class="keyword">this</span>[i].name %&gt;
&lt;/li&gt;
</code></pre>

<p>In your code, add a <strong>returning</strong>  magic tag (<code>&lt;%= %&gt;</code>) that 
matches the <em>arrow function syntax</em>.  The argument passed to the function will
be the jQuery-wrapped element.  </p>

<p>This lets you hookup model data to elements in EJS.  Change <strong>todos.ejs</strong> to:</p>

<pre><code class=" javascript">&lt;% $.each(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span><span class="params">(i, todo)</span>{</span> %&gt;
  &lt;li &lt;%= ($el) -&gt; $el.model(todo) %&gt;&gt;
    &lt;%= todo.name %&gt;
    &lt;a href=<span class="string">"javascript://"</span> class=<span class="string">'destroy'</span>&gt;X&lt;/a&gt;
  &lt;/li&gt;
&lt;% }) %&gt;
</code></pre>

<h2>Controller <code>$.Controller(name, classProps, prototypeProps)</code></h2>

<p><a href="#!jQuery.Controller">$.Controller</a> creates organized, memory-leak free, 
rapidly performing, stateful jQuery widgets. It is used to create UI controls like 
tabs, grids, and contextmenus and used to organize them 
into higher-order business rules with <a href="#!jQuery.route">$.route</a>. Its serves as 
both a traditional view and a 
traditional controller.</p>

<p>Let's make a basic todos widget that 
lists todos and lets 
us destroy them. Add the following to <strong>todos.js</strong>:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>
    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )
  }
})
</code></pre>

<p>We can create this widget on the <code>#todos</code> element with:</p>

<pre><code class=" javascript"><span class="keyword">new</span> Todos(<span class="string">'#todos'</span>, {});
</code></pre>

<h3>init <code>$.Controller.prototype.init(element, options)</code></h3>

<p><a href="#!jQuery.Controller.prototype.init">Init</a> is called when a
new Controller instance is created.  It's called with:</p>

<ul>
<li><strong>element</strong> - The jQuery wrapped element passed to the 
              controller.  Controller accepts a jQuery element, a
              raw HTMLElement, or a css selector.  This is
              set as <strong>this.element</strong> on the controller instance.</li>
<li><strong>options</strong> - The second argument passed to new Controller, extended with
              the Controller's static <strong>defaults</strong>. This is set as 
              <strong>this.options</strong> on the controller instance.</li>
</ul>

<p>and any other arguments passed to <code>new Controller()</code>.  For example:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,
{
  defaults : {template: <span class="string">'todos.ejs'</span>}
},
{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>
    element.html(options.template, Todo.findAll() )
  }
})

<span class="keyword">new</span> Todos( document.body.firstElementChild );
<span class="keyword">new</span> Todos( $(<span class="string">'#todos'</span>), {template: <span class="string">'specialTodos.ejs'</span>})
</code></pre>

<h3>element <code>this.element</code></h3>

<p><a href="#!jQuery.Controller.prototype.element">this.element</a> is the jQuery-wrapped
element the controller is created on. </p>

<h3>options <code>this.options</code></h3>

<p><a href="#!jQuery.Controller.prototype.options">this.options</a> is the second argument passed to 
<code>new Controller()</code> merged with the controller's static <strong>defaults</strong> property.</p>

<h3>Listening to events</h3>

<p>Controller automatically binds prototype methods that look
like event handlers.  Listen to <strong>click</strong>s on <code>&lt;li&gt;</code> elements like:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>
    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )
  },
  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li, event)</span>{</span>
    console.log(<span class="string">"You clicked"</span>, li.text() )

    <span class="comment">// let other controls know what happened</span>
    li.trigger(<span class="string">'selected'</span>);
  }
})
</code></pre>

<p>When an <code>&lt;li&gt;</code> is clicked, <code>"li click"</code> is called with:</p>

<ul>
<li>The jQuery-wrapped <strong>element</strong> that was clicked</li>
<li>The <strong>event</strong> data</li>
</ul>

<p>Controller uses event delegation, so you can add <code>&lt;li&gt;</code>s without needing to rebind
event handlers.</p>

<p>To destroy a todo when it's <code>&lt;a href='javascript:// class='destroy'&gt;</code> link 
is clicked:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>
    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )
  },
  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span>
    li.trigger(<span class="string">'selected'</span>, li.model() );
  },
  <span class="string">"li .destroy click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>
    <span class="comment">// get the li element that has the model</span>
    <span class="keyword">var</span> li = el.closest(<span class="string">'.todo'</span>);

    <span class="comment">// get the model</span>
    <span class="keyword">var</span> todo = li.model()

    <span class="comment">//destroy it</span>
    todo.destroy(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
      <span class="comment">// remove the element</span>
      li.remove();
    });
  }
})
</code></pre>

<h3>Templated Event Handlers Pt 1 <code>"{optionName}"</code></h3>

<p>Customize event handler behavior with <code>"{NAME}"</code> in
the event handler name.  The following allows customization 
of the event that destroys a todo:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span> ... },
  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span> ... },

  <span class="string">"li .destroy {destroyEvent}"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span> 
    <span class="comment">// previous destroy code here</span>
  }
})

<span class="comment">// create Todos with this.options.destroyEvent</span>
<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>,{destroyEvent: <span class="string">"mouseenter"</span>})
</code></pre>

<p>Values inside <code>{NAME}</code> are looked up on the controller's <code>this.options</code>
and then the <code>window</code>.  For example, we could customize it instead like:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span> ... },
  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span> ... },

  <span class="string">"li .destroy {Events.destroy}"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span> 
    <span class="comment">// previous destroy code here</span>
  }
})

<span class="comment">// Events config</span>
Events = {destroy: <span class="string">"click"</span>};

<span class="comment">// Events.destroy is looked up on the window.</span>
<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)
</code></pre>

<p>The selector can also be templated.</p>

<h3>Templated Event Handlers Pt 2 <code>"{objectName}"</code></h3>

<p>Controller can also bind to objects other than <code>this.element</code> with
templated event handlers.  This is <strong>especially critical</strong>
for avoiding memory leaks that are so common among MVC applications.  </p>

<p>If the value inside <code>{NAME}</code> is an object, that object will be 
bound to.  For example, the following tooltip listens to 
clicks on the window:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Tooltip"</span>,{
  <span class="string">"{window} click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>
    <span class="comment">// hide only if we clicked outside the tooltip</span>
    <span class="keyword">if</span>(! <span class="keyword">this</span>.element.has(ev.target ) {
      <span class="keyword">this</span>.element.remove();
    }
  }
})

<span class="comment">// create a Tooltip</span>
<span class="keyword">new</span> Tooltip( $(<span class="string">'&lt;div&gt;INFO&lt;/div&gt;'</span>).appendTo(el) )
</code></pre>

<p>This is convenient when needing to 
listen to model updates.  Instead of adding a callback
to <code>todo.destroy(cb)</code>, we should be listening to 
<strong>destroyed</strong> events.  We'll handle <strong>updated</strong> too:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Todos"</span>,{
  <span class="string">"init"</span> : <span class="function"><span class="keyword">function</span><span class="params">( element , options )</span>{</span>
    <span class="keyword">this</span>.element.html(<span class="string">'todos.ejs'</span>, Todo.findAll() )
  },
  <span class="string">"li click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(li)</span>{</span>
    li.trigger(<span class="string">'selected'</span>, li.model() );
  },
  <span class="string">"li .destroy click"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>
    el.closest(<span class="string">'.todo'</span>)
      .model()
      .destroy();
    ev.stopPropagation();
  },
  <span class="string">"{Todo} destroyed"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Todo, ev, destroyedTodo)</span>{</span>
    destroyedTodo.elements(<span class="keyword">this</span>.element)
                 .remove();
  },
  <span class="string">"{Todo} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Todo, ev, updatedTodo)</span>{</span>
    updatedTodo.elements(<span class="keyword">this</span>.element)
               .replaceWith(<span class="string">'todos.ejs'</span>,[updatedTodo]);
  }
})

<span class="keyword">new</span> Todos(<span class="string">"#todos"</span>);
</code></pre>

<p>This is better because it removes the todo's element from the page even if another widget
destroyed the todo. Also, this works very well with real-time
architectures.</p>

<h3>destroy <code>controller.destroy()</code></h3>

<p><a href="#!jQuery.Controller.prototype.destroy">$.Controller.prototype.destroy</a> unbinds a controller's
event handlers and releases its element, but does not remove 
the element from the page. </p>

<pre><code class=" javascript"><span class="keyword">var</span> todo = <span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)
todo.destroy();
</code></pre>

<p>When a controller's element is removed from the page
<strong>destroy</strong> is called automatically.</p>

<pre><code class=" javascript"><span class="keyword">new</span> Todos(<span class="string">"#todos"</span>)
$(<span class="string">"#todos"</span>).remove();
</code></pre>

<p>All event handlers bound with Controller are unbound when the controller 
is destroyed (or its element is removed).</p>

<p><em>Brief aside on destroy and templated event binding. Taken 
together, templated event binding, and controller's automatic
clean-up make it almost impossible 
to write leaking applications. An application that uses
only templated event handlers on controllers within the body
could free up all 
data by calling <code>$(document.body).empty()</code>.</em></p>

<h3>update <code>controller.update(options)</code></h3>

<p><a href="#!jQuery.Controller.prototype.update">$.Controller.prototype.update</a> updates a controller's 
<code>this.options</code> and rebinds all event handlers.  This is useful
when you want to listen to a specific model:</p>

<pre><code class=" javascript">$.Controller(<span class="string">'Editor'</span>,{
  update : <span class="function"><span class="keyword">function</span><span class="params">(options)</span>{</span>
    <span class="keyword">this</span>._super(options)
    <span class="keyword">this</span>.setName();
  },
  <span class="comment">// a helper that sets the value of the input</span>
  <span class="comment">// to the todo's name</span>
  setName : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">this</span>.element.val(<span class="keyword">this</span>.options.todo.name);
  },
  <span class="comment">// listen for changes in the todo</span>
  <span class="comment">// and update the input</span>
  <span class="string">"{todo} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">this</span>.setName();
  },
  <span class="comment">// when the input changes</span>
  <span class="comment">// update the todo instance</span>
  <span class="string">"change"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">var</span> todo = <span class="keyword">this</span>.options.todo
    todo.attr(<span class="string">'name'</span>,<span class="keyword">this</span>.element.val() )
    todo.save();
  }
});

<span class="keyword">var</span> todo1= <span class="keyword">new</span> Todo({id: <span class="number">6</span>, name: <span class="string">"trash"</span>}),
    todo2 = <span class="keyword">new</span> Todo({id: <span class="number">6</span>, name: <span class="string">"dishes"</span>});

<span class="comment">// create the editor;</span>
<span class="keyword">var</span> editor = <span class="keyword">new</span> Editor(<span class="string">"#editor"</span>);

<span class="comment">// show the first todo</span>
editor.update({todo: todo1})

<span class="comment">// switch it to the second todo</span>
editor.update({todo: todo2});
</code></pre>

<p>Notice that because we are overwriting <code>update</code>, we must call <strong>_super</strong>.</p>

<h2>Routing</h2>

<p><a href="#!jQuery.route">$.route</a> is the core of JavaScriptMVC's 
routing functionality. It is a <a href="#!jQuery.Observe">jQuery.Observe</a> that
updates <code>window.location.hash</code> when it's properties change
and updates its properties when <code>window.location.hash</code> 
changes. It allows very sophisticated routing behavior ... too
sophisticated for this guide. But, it also handles 
the basics with ease.  </p>

<p>Listen to routes in controller's with special "route" events like:</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Routing"</span>,{
  <span class="string">"route"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="comment">// matches empty hash, #, or #!</span>
  },
  <span class="string">"todos/:id route"</span> : <span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
    <span class="comment">// matches routes like #!todos/5</span>
  }
})

<span class="comment">// create routing controller</span>
<span class="keyword">new</span> Routing(document.body);
</code></pre>

<p>The <code>route</code> methods get called back with the route <strong>data</strong>.  The 
empty <code>"route"</code> will be called with no data. But, <code>"todos/:id route"</code>
will be called with data like: <code>{id: 6}</code>.</p>

<p>We can update the route by changing $.route's data like:</p>

<pre><code class=" javascript">$.route.attr(<span class="string">'id'</span>,<span class="string">'6'</span>) <span class="comment">// location.hash = #!todos/6</span>
</code></pre>

<p>Or we can set the hash ourselves like</p>

<pre><code class=" javascript"><span class="keyword">var</span> hash = $.route.url({id: <span class="number">7</span>}) <span class="comment">// #!todos/7</span>
location.hash = hash;
</code></pre>

<p>The following enhances the Routing controller to listen for
<code>".todo selected"</code> events and change the <code>$.route</code>.  When the
$.route changes, it retrieves the todo from the server
and updates the editor widget.</p>

<pre><code class=" javascript">$.Controller(<span class="string">"Routing"</span>,{
  init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">this</span>.editor = <span class="keyword">new</span> Editor(<span class="string">"#editor"</span>)
    <span class="keyword">new</span> Todos(<span class="string">"#todos"</span>);
  },
  <span class="comment">// the index page</span>
  <span class="string">"route"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
     $(<span class="string">"#editor"</span>).hide();
  },
  <span class="string">"todos/:id route"</span> : <span class="function"><span class="keyword">function</span><span class="params">(data)</span>{</span>
    $(<span class="string">"#editor"</span>).show();
    Todo.findOne(data, $.proxy(<span class="function"><span class="keyword">function</span><span class="params">(todo)</span>{</span>
      <span class="keyword">this</span>.editor.update({todo: todo});
    }, <span class="keyword">this</span>))
  },
  <span class="string">".todo selected"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev, todo)</span>{</span>
    $.route.attr(<span class="string">'id'</span>,todo.id);
  }
});

<span class="comment">// create routing controller</span>
<span class="keyword">new</span> Routing(document.body);
</code></pre>

<p>The <strong>Routing</strong> controller is a traditional controller. It coordinates
between the <code>$.route</code>, <code>Editor</code> and <code>Todos</code>.  <code>Editor</code> and <code>Todos</code>
are traditional views, consuming models.</p>

<p>If you can understand this, you understand 
everything. Congrats!  [//tutorials/rapidstart/todos.html See it in action].</p>

<h2>FuncUnit</h2>

<p>JavaScriptMVC uses <a href="#!FuncUnit">FuncUnit</a> for testing.  FuncUnit provides an API for writing functional 
tests that simulate clicks and keypresses a user would make.</p>

<p>To create a FuncUnit test:</p>

<ul>
<li>Create a test file that steals funcunit and</li>
<li>Create a funcunit.html page that steals your test file</li>
</ul>

<p>In the <strong>todos</strong> directory, make funcunit.html and add the following HTML:</p>

<pre><code class=" javascript">&lt;html&gt;
  &lt;head&gt;
    &lt;link rel=<span class="string">"stylesheet"</span> type=<span class="string">"text/css"</span> 
      href=<span class="string">"../funcunit/qunit/qunit.css"</span> /&gt;
    &lt;script type=<span class="string">'text/javascript'</span> 
      src=<span class="string">'../steal/steal.js?todos/funcunit.js'</span>&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1 id=<span class="string">"qunit-header"</span>&gt;Todos Test Suite&lt;/h1&gt;
    &lt;h2 id=<span class="string">"qunit-banner"</span>&gt;&lt;/h2&gt;
    &lt;div id=<span class="string">"qunit-testrunner-toolbar"</span>&gt;&lt;/div&gt;
    &lt;h2 id=<span class="string">"qunit-userAgent"</span>&gt;&lt;/h2&gt;
    &lt;div id=<span class="string">"test-content"</span>&gt;&lt;/div&gt;
    &lt;ol id=<span class="string">"qunit-tests"</span>&gt;&lt;/ol&gt;
    &lt;div id=<span class="string">"qunit-test-area"</span>&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Now make <strong>funcunit.js</strong> and add the following:</p>

<pre><code class=" javascript">steal(<span class="string">'funcunit'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>

  module(<span class="string">'todos'</span>)

  test(<span class="string">'todos test'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    ok(<span class="literal">true</span>, <span class="string">"the test loads"</span>);
  })

})
</code></pre>

<p>Open <strong>funcunit.html</strong> in your browser.  One test passes.</p>

<h3>Writing a test</h3>

<p>We tell the test to open the todos page using <a href="#!FuncUnit.open">S.open</a>:</p>

<pre><code class=" javascript">S.open(<span class="string">"//todos/todos.html"</span>);
</code></pre>

<p>Once the page is open, we select the first todo and click it:</p>

<pre><code class=" javascript">S(<span class="string">".todo:first"</span>).click();
</code></pre>

<p>S is a copy of jQuery's $ that adds FuncUnit's API. The editor input will 
now appear.  Tell FuncUnit to wait for this using a <a href="#!funcunit.waits">wait</a> command:</p>

<pre><code class=" javascript">S(<span class="string">"#editor"</span>).val(<span class="string">"wake up"</span>, <span class="string">"First Todo added correctly"</span>);
</code></pre>

<p>The second parameter is an assertion message.</p>

<p>Replace the test code within the steal callback with the following:</p>

<pre><code class=" javascript">module(<span class="string">'todos'</span>, {
  setup: <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    S.open(<span class="string">"//todos/todos.html"</span>);
  }
})

test(<span class="string">'open first todo'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  S(<span class="string">".todo:first"</span>).click();
  S(<span class="string">"#editor"</span>).val(<span class="string">"wake up"</span>, <span class="string">"First Todo added correctly"</span>);
})
</code></pre>

<p>Reload <strong>funcunit.html</strong>.  You'll see the page open and run the test in a separate window.</p>

<p>FuncUnit has the ability to provide code coverage stats.  <a href="http://javascriptmvc.com/tutorials/rapidstart/funcunit.html?steal[instrument]=jquery,funcunit,steal,documentjs,*/test,*_test.js,mxui,*funcunit.js">Click</a> 
the checkbox next to coverage to 
see a coverage report.  81% isn't bad!  Click Todos.js to see a line by line breakdown.</p>

<h3>Automation</h3>

<p>To run these tests automated, run the following from the console:</p>

<pre><code class=" javascript">.<span class="regexp">/js funcunit/</span>run selenium todos/funcunit.html
</code></pre>

<p>FuncUnit supports <a href="#!funcunit.integrations">integration</a> with CI tools 
like <a href="#!funcunit.jenkins">Jenkins</a>, build tools like <a href="#!funcunit.maven">maven</a>, 
and running via the <a href="#!funcunit.phantomjs">PhantomJS</a> headless browser.</p></div>
			<div id="disqus_thread" style="display: none; "></div>
		</div>
	</div>
</div>
<div id="low">
	<a href="http://jupiterit.com"> Jupiter Consulting - JavaScriptMVC Training and Support</a>
	<a class="api_links" href="http://javascriptmvc.com/docs/api.html#&amp;who=api"></a>
</div>
<script type="text/javascript">
	DOCS_SRC_MAP = {
		'funcunit' : 'https://github.com/jupiterjs/funcunit',
		'jquery' : 'https://github.com/jupiterjs/jquerymx',
		'steal' : 'https://github.com/jupiterjs/steal',
		'documentjs' : 'https://github.com/jupiterjs/documentjs',
		mxui : 'https://github.com/jupiterjs/mxui'
	};
	DOCS_LOCATION = "docs/" //adds searchData to this
	JMVCDOC_TIMESTAMP = 265469885
	COMMENTS_LOCATION = 'http://jmvcs3.disqus.com/embed.js';
</script>
<script type="text/javascript" src="../steal/steal.js?documentjs/jmvcdoc">
</script>

<style type="text/css">
  body > iframe { width: 0;} 
  #dsq-content #dsq-form-area .dsq-attach-media-container iframe { height: 13px; padding: 0;}
</style>
	

</body>
</html>
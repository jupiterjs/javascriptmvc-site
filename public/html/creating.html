<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
		"http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head><script type="text/javascript" src="http://localhost:5555?[]&amp;_=0.8374656161759049"></script>
	<title>Creating Cookbook</title>
	<link rel="stylesheet" type="text/css" href="../documentjs/jmvcdoc/style.css">
	<link rel="shortcut icon" href="../documentjs/jmvcdoc/images/favicon.ico">
	<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxx-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link rel="stylesheet" href="file:////Users/alexisabril/Projects/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/style.css" type="text/css"></head><body>
<div id="documentation">
	<div id="top">
		<div class="topCorner">
			<div class="right"></div>
			<div class="left"></div>
		</div>
		<div class="content">
			<div id="searchRoundCorners">
				<div class="jmvcdoc_search"><input id="search" type="input"><span title="clear term" class="remove"></span></div>
			</div>
			<div id="defaults">
				<ul id="menu" class="ui-menu">
					<li class="ui-menu-item">
						<a class="menuLink" href="#favorites"><span class="menuSpan">Favorites</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../follow.html" title="Follow"><span class="menuSpan red">Follow</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../contribute.html" title="Contribute"><span class="menuSpan red">Contribute</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../code.html" title="Code"><span class="menuSpan red">Code</span></a>
					</li>
				</ul>
			</div>
			<div class="logo-text"><a href="http://javascriptmvc.com"><img src="../documentjs/jmvcdoc/images/logo80x30.png" class="logo-image"></a></div>
		</div>
		<div class="bottomCorner">
			<div>&nbsp;</div>
		</div>
	</div>
	<div id="bottom">
		<div id="nav" class="jmvcdoc_nav">


	<div id="selected">
		    
				
		<div class="content">
			    <a href="#!" class="selected choice page" style="padding-left: 20px">
			    	
					JavaScriptMVC
					
				</a>
				
		</div>
			
		<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!tutorials" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Tutorials
					
				</a>
				
		</div>
			
		<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!getstarted" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Get Started with JavaScriptMVC
					
				</a>
				
		</div>
			
			
	</div>

<div id="results" style="display: block">
	<div class="content">
	    
			
		    <a href="#!creating" class="result choice page open" style="padding-left: 20px">
		    	Creating Cookbook
			</a>
			
		
			
		    <a href="#!testing" class="result choice page" style="padding-left: 20px">
		    	Testing Cookbook
			</a>
			
		
			
		    <a href="#!compressing" class="result choice page" style="padding-left: 20px">
		    	Compressing Cookbook
			</a>
			
		
			
		    <a href="#!documenting" class="result choice page" style="padding-left: 20px">
		    	Documenting Cookbook
			</a>
			
		
	</div>
</div>


</div>
		<div id="doc_container">
			<div id="doc" class="jmvcdoc_content">
<div class="top">
	<div class="content">
	    <h1>Creating Cookbook&nbsp;
	    	<span class="page type"><span class="typeEnd">page</span></span>&nbsp;
	    	<span class="favorite favoriteoff">&nbsp;&nbsp;&nbsp;</span></h1>
	    
	    
	    
		
		
		
	</div>	
</div>


<p>We're going to create a basic cookbook application that
lets us create, and delete recipes. It will look like:</p>

<p><img class="image_tag" src="file:////Users/alexisabril/Projects/javascriptmvc-site/javascriptmvc/tutorials/getstarted/Cookbook.png"></p>

<p>JavaScriptMVC uses 
<a href="#!steal.generate">generator scripts</a> to 
assist you
in setting up your application's 
files and folders.  They make everything you need to fall
into the pit of success!</p>

<h2>Generating an Application</h2>

<p>To create your application, open a console window and 
navigate to your public directory. Run:</p>

<pre><code class=" javascript">&gt; js jquery\generate\app cookbook
</code></pre>

<p>This script creates an application folder and 
files. Here's what each file does:</p>

<pre><code class=" javascript">cookbook/                <span class="comment">// folder for your app</span>
  cookbook.css           <span class="comment">// css for your app</span>
  cookbook.html          <span class="comment">// a page for your app</span>
  cookbook.js            <span class="comment">// app file, loads other files</span>
  docs/                  <span class="comment">// documentation</span>
  fixtures/              <span class="comment">// simulated ajax responses</span>
  funcunit.html          <span class="comment">// functional test page</span>
  models/                <span class="comment">// model &amp; data layers</span>
  qunit.html             <span class="comment">// unit test page</span>
  scripts/               <span class="comment">// command line scripts</span>
    build.html           <span class="comment">// html for build script</span>
    build.js             <span class="comment">// build script</span>
    clean.js             <span class="comment">// code cleaning / linting</span>
    crawl.js             <span class="comment">// generate search content</span>
    docs.js              <span class="comment">// create documentation</span>
  test/                    
    funcunit             <span class="comment">// functional tests</span>
      cookbook_test.js   <span class="comment">// functional test</span>
      funcunit.js        <span class="comment">// loads functional tests</span>
    qunit/               <span class="comment">// unit tests</span>
      cookbook_test.js   <span class="comment">// unit test</span>
      qunit.js           <span class="comment">// loads unit tests</span>
</code></pre>

<p>We'll use cookbook.html for our application. If 
you need to make another page for your app you 
can generate it:</p>

<pre><code class="text javascript">&gt; js jquery\generate\page cookbook index.html
Generating ... index.html</code></pre>

<p>Or you add the steal script to an existing page 
page followed by <code>?cookbook</code> like:</p>

<pre><code class="html"><span class="tag">&lt;<span class="keyword">script</span><span class="attribute"> type=<span class="value">'text/javascript'</span></span>
       <span class="attribute"> src=<span class="value">'../path/to/steal/steal.js?cookbook'</span></span>&gt;</span><span class="javascript">
</span><span class="tag">&lt;/<span class="keyword">script</span>&gt;</span></code></pre>

<p>If you open cookbook/cookbook.html, you'll see a
JavaScriptMVC welcome screen.  </p>

<p><img class="image_tag" src="file:////Users/alexisabril/Projects/javascriptmvc-site/javascriptmvc/tutorials/getstarted/Welcome.png"></p>

<p>Open <code>cookbook/cookbook.html</code> and you will find:</p>

<pre><code class="html">&lt;script type='text/javascript' 
        src='../steal/steal.js?cookbook'&gt;</code></pre>

<p>This line loads <a href="#!steal">steal</a> and tells steal to 
load <code>cookbook/cookbook.js</code>. <code>cookbook/cookbook.js</code> is
your application file.  Open it and you will find:</p>

<pre><code class=" javascript">steal(
    <span class="string">'./cookbook.css'</span>,           <span class="comment">// application CSS file</span>
    <span class="string">'./models/models.js'</span>,       <span class="comment">// steals all your models</span>
    <span class="string">'./fixtures/fixtures.js'</span>,   <span class="comment">// sets up fixtures for your models</span>
    <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>                 <span class="comment">// configure your application</span>

})
</code></pre>

<p>The application file loads and configures your applications resources.  Currently,
it's loading the app's css file, models and fixtures (there are no fixtures or models yet).</p>

<p>Now it's time to make some widgets, models, and fixtures that allow us to create and delete
recipes!  </p>

<h2>Scaffolding Recipes</h2>

<p>We'll use the scaffold generator to quickly create:</p>

<ul>
<li>A Recipe model for CRUDing recipes on the server</li>
<li>A Fixture for simulating a recipe service</li>
<li>A widget for creating recipes</li>
<li>A widget for listing and deleting recipes</li>
</ul>

<p>To scaffold recipes run the following in the command-line console:</p>

<pre><code class="text javascript">&gt; js jquery\generate\scaffold Cookbook.Models.Recipe</code></pre>

<p>Here's what each part does:</p>

<p><strong>recipe.js</strong></p>

<p>Creates a recipe <a href="#!jQuery.Model">model</a> that is used
to create, retrieve, updated, and delete 
recipes on the server.</p>

<p><strong>recipe_test.js</strong></p>

<p>Tests the recipe model.</p>

<p><strong>fixtures.js</strong></p>

<p>The generator added code to simulate the Recipe Model's Ajax
requests (You might not have a Recipe service).</p>

<p><strong>recipe/create</strong></p>

<p>This folder contains the code, demo page, and tests for a
widget that creates Recipes.</p>

<p><strong>recipe/list</strong></p>

<p>This folder contains the code, demo page, and tests for a
widget that lists recipes.</p>

<p><strong>(steal added)</strong></p>

<p>The generator will also list files that 
say "(steal added)". For example:</p>

<pre><code class="text javascript">cookbook/models/models.js (steal added)</code></pre>

<p>The "(steal added)" means the generator is 
adding a steal call to load
a generated file for you.  For example, 
<code>cookbook/models/models.js</code> now steals your
<code>recipe.js</code> model like:</p>

<pre><code class=" javascript">steal(<span class="string">'./recipe.js'</span>)
</code></pre>

<h2>Page Setup</h2>

<p>After the generator runs, your application file (<code>cookbook.js</code>)
looks like:</p>

<pre><code class=" javascript">steal(
    <span class="string">'./cookbook.css'</span>,           <span class="comment">// application CSS file</span>
    <span class="string">'./models/models.js'</span>,       <span class="comment">// steals all your models</span>
    <span class="string">'./fixtures/fixtures.js'</span>,   <span class="comment">// sets up fixtures for your models</span>
    <span class="string">'cookbook/create'</span>,
    <span class="string">'cookbook/list'</span>,
    <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>                 <span class="comment">// configure your application</span>

        $(<span class="string">'#recipes'</span>).cookbook_recipe_list();
        $(<span class="string">'#create'</span>).cookbook_recipe_create();
})
</code></pre>

<p>You'll notice that it now loads <code>cookbook/create</code>
and <code>cookbook/list</code> and then tries to add these widgets to the
<code>#recipes</code> and <code>#create</code> elements.  </p>

<p>However, <code>#recipes</code> and <code>#create</code> elements do not 
exist.  All we have to do now is add them.  Open <strong>cookbook/cookbook.html</strong>
and add a <code>#recipes</code> <strong>ul</strong> and a <code>#create</code> <strong>form</strong>
so it looks like:</p>

<pre><code class="html"><span class="doctype">&lt;!DOCTYPE HTML&gt;</span>
<span class="tag">&lt;<span class="keyword">html</span><span class="attribute"> lang=<span class="value">"en"</span></span>&gt;</span>
    <span class="tag">&lt;<span class="keyword">head</span>&gt;</span>
        <span class="tag">&lt;<span class="keyword">title</span>&gt;</span>cookbook<span class="tag">&lt;/<span class="keyword">title</span>&gt;</span>
    <span class="tag">&lt;/<span class="keyword">head</span>&gt;</span>
    <span class="tag">&lt;<span class="keyword">body</span>&gt;</span>
        <span class="tag">&lt;<span class="keyword">h1</span>&gt;</span>Welcome to JavaScriptMVC 3.2!<span class="tag">&lt;/<span class="keyword">h1</span>&gt;</span>
        <span class="tag">&lt;<span class="keyword">ul</span><span class="attribute"> id=<span class="value">'recipes'</span></span>&gt;</span><span class="tag">&lt;/<span class="keyword">ul</span>&gt;</span>
        <span class="tag">&lt;<span class="keyword">form</span><span class="attribute"> id=<span class="value">'create'</span></span><span class="attribute"> action=<span class="value">''</span></span>&gt;</span><span class="tag">&lt;/<span class="keyword">form</span>&gt;</span>
        <span class="tag">&lt;<span class="keyword">script</span><span class="attribute"> type=<span class="value">'text/javascript'</span></span> 
               <span class="attribute"> src=<span class="value">'../steal/steal.js?cookbook'</span></span>&gt;</span><span class="javascript">    
        </span><span class="tag">&lt;/<span class="keyword">script</span>&gt;</span>
    <span class="tag">&lt;/<span class="keyword">body</span>&gt;</span>
<span class="tag">&lt;/<span class="keyword">html</span>&gt;</span></code></pre>

<h2>Run Cookbook</h2>

<p>That's it. You've created a simple Cookbook 
application. Open cookbook/cookbook.html in a browser. </p>

<p><img class="image_tag" src="file:////Users/alexisabril/Projects/javascriptmvc-site/javascriptmvc/tutorials/getstarted/Cookbook.png"></p>

<div style="background-color: #dddddd;  margin: 20px 0px;padding: 20px">
<p>
<b style="color:red">NOTICE:</b> 
If you are having problems and 
using Chrome from the filesystem, it's because Chrome has an
<a href="http://code.google.com/p/chromium/issues/detail?id=47416">insanely restrictive AJAX policies on the filesystem</a>.
</p>
<p>
Essentially, Chrome does not allow AJAX requests to
files outside the html page's folder.  JavaScriptMVC
organizes your files into separate folders.
</p>
<p>
To fix this, just run JavaScriptMVC from a web server.
Or, you can use another browser.  Or you can add
<code>--allow-file-access-from-files</code> to Chrome's start script.
</p>
<p>
If you're annoyed like we are, 
<a href="http://code.google.com/p/chromium/issues/detail?id=47416">star the issue</a>
and let 
google know you'd like Chrome to work on the filesystem!
</p>
</div>

<p>Continue to <a href="#!testing">Testing Cookbook</a> or continue to read how
this code works.</p>

<h2>How it Works</h2>

<p>The Cookbook application can be broken into 5 parts:</p>

<ul>
<li>The Recipe Model</li>
<li>The Recipe Fixture</li>
<li>The Recipe Create control</li>
<li>The Recipe List control</li>
<li>The Cookbook application that puts it all together</li>
</ul>

<h3>The Recipe Model and Fixture</h3>

<p><code>cookbook/models/recipe.js</code> looks like:</p>

<pre><code class=" javascript">steal(<span class="string">'jquery/model'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>

  $.Model(<span class="string">'Cookbook.Models.Recipe'</span>,
  {
    findAll: <span class="string">"/recipes.json"</span>,
    findOne : <span class="string">"/recipes/{id}.json"</span>, 
    create : <span class="string">"/recipes.json"</span>,
    update : <span class="string">"/recipes/{id}.json"</span>,
    destroy : <span class="string">"/recipes/{id}.json"</span>
  },
  {});
})
</code></pre>

<p>This loads <a href="#!jQuery.Model">$.Model</a> and uses it to create a 
<code>Cookbook.Models.Recipe</code> class.  This class lets us
create, retrieve, update, and delete models programmatically like:</p>

<p><strong>create</strong></p>

<pre><code class=" javascript"><span class="comment">// create a recipe instance</span>
<span class="keyword">var</span> recipe = <span class="keyword">new</span> Cookbook.Models.Recipe({
  name: <span class="string">'Hot Dog'</span>,
  description: <span class="string">'nuke dog, put in bun'</span>
 })

<span class="comment">// call save to create on the server</span>
recipe.save()
</code></pre>

<p><strong>retrieve</strong></p>

<pre><code class=" javascript"><span class="comment">// get recipes from the server</span>
Cookbook.Models.Recipe.findAll({}, <span class="function"><span class="keyword">function</span><span class="params">(recipes)</span>{</span>
  <span class="comment">// do something with recipes</span>
})
</code></pre>

<p><strong>update</strong></p>

<pre><code class=" javascript"><span class="comment">// update the properties of a created recipe</span>
recipe.attrs({
  name: <span class="string">'Bratwurst'</span>,
  description: <span class="string">'nuke bratwurst, put in bun'</span>
});

<span class="comment">// call save to send updates to the server</span>
recipe.save()
</code></pre>

<p><strong>delete</strong></p>

<pre><code class=" javascript"><span class="comment">// call destroy</span>
recipe.destroy()
</code></pre>

<p>Of course, we don't have a server to make requests to.  This is
where fixtures come in.</p>

<h3>The Recipe Fixture</h3>

<p><a href="#!jQuery.fixture">Fixtures</a> intercept Ajax requests and 
simulate the response. They are a great tool that enables
you to start work on the front end without a ready server.</p>

<p>Open <code>cookbook/fixtures/fixtures.js</code> and you will find:</p>

<pre><code class=" javascript">$.fixture.make(<span class="string">"recipe"</span>, <span class="number">5</span>, <span class="function"><span class="keyword">function</span><span class="params">(i, recipe)</span>{</span>
    <span class="keyword">var</span> descriptions = [<span class="string">"grill fish"</span>, <span class="string">"make ice"</span>, <span class="string">"cut onions"</span>]
    <span class="keyword">return</span> {
        name: <span class="string">"recipe "</span>+i,
        description: $.fixture.rand( descriptions , <span class="number">1</span>)
    }
})
</code></pre>

<p>The scaffold generator added this to simulate a server 
with 5 recipes.  Read more about how this works on
<a href="#!jQuery.fixture.make">make's documentation page</a>.</p>

<h3>The Recipe Create Control</h3>

<p>Open <code>cookbook/recipe/create/create.html</code> in your 
browser.  This page demos the Cookbook.Recipe.Create control and
lets you create recipes.  It lets us work on Cookbook.Recipe.Create
independent of the rest of the application.</p>

<p>Open <code>cookbook/recipe/create/create.js</code> to
see the Cookbook.Recipe.Create control's code:</p>

<pre><code class=" javascript">steal( <span class="string">'jquery/controller'</span>,
       <span class="string">'jquery/view/ejs'</span>,
       <span class="string">'jquery/dom/form_params'</span>,
       <span class="string">'jquery/controller/view'</span>,
       <span class="string">'cookbook/models'</span> )
.then(<span class="string">'./views/init.ejs'</span>, <span class="function"><span class="keyword">function</span><span class="params">($)</span>{</span>

  $.Controller(<span class="string">'Cookbook.Recipe.Create'</span>,
  {
    init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
      <span class="keyword">this</span>.element.html(<span class="keyword">this</span>.view());
    },
    submit : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>
      ev.preventDefault();
      <span class="keyword">this</span>.element.find(<span class="string">'[type=submit]'</span>).val(<span class="string">'Creating...'</span>);
      <span class="keyword">new</span> Cookbook.Models.Recipe(el.formParams()).save(<span class="keyword">this</span>.callback(<span class="string">'saved'</span>));
    },
    saved : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
      <span class="keyword">this</span>.element.find(<span class="string">'[type=submit]'</span>).val(<span class="string">'Create'</span>);
      <span class="keyword">this</span>.element[<span class="number">0</span>].reset();
    }
  });
});
</code></pre>

<p>This code uses <a href="#!steal">steal</a> to load dependencies and then creates a 
<code>Cookbook.Recipe.Create</code> controller.  This creates
a <code>cookbook<em>recipe</em>create</code> jQuery helper function that
can be called on a form element like:</p>

<pre><code class=" javascript">$(<span class="string">'form#create'</span>).cookbook_recipe_create()
</code></pre>

<p>When the jQuery plugin is called, the controller's <code>init</code>
method is called and runs </p>

<pre><code class=" javascript"><span class="keyword">this</span>.element.html(<span class="keyword">this</span>.view());
</code></pre>

<p>This code renders the template at <code>cookbook/recipe/create/views/init.ejs</code>
into the controller's <a href="#!jQuery.Controller.prototype.element">element</a>.</p>

<p>When the jQuery plugin is called controller also binds event handlers on the
controller's element.  In this case, it listens for "submit" events on the element.</p>

<p>When a submit event happens, it updates the submit button's text, then creates
a new recipe.</p>

<h3>The Recipe List Control</h3>

<p>Open <code>cookbook/recipe/create/create.html</code> in your 
browser.  This page demos the Cookbook.Recipe.List control. It loads
Recipes from the server, lets you delete recipes, and it also 
listens for recipes being created and adds them to the list.</p>

<p>Open <code>cookbook/recipe/list/list.js</code> to
see the Cookbook.Recipe.Create control's code:</p>

<pre><code class=" javascript">$.Controller(<span class="string">'Cookbook.Recipe.List'</span>,
{
  init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">this</span>.element.html(<span class="keyword">this</span>.view(<span class="string">'init'</span>,Cookbook.Models.Recipe.findAll()) )
  },
  <span class="string">'.destroy click'</span>: <span class="function"><span class="keyword">function</span><span class="params">( el )</span>{</span>
    <span class="keyword">if</span>(confirm(<span class="string">"Are you sure you want to destroy?"</span>)){
      el.closest(<span class="string">'.recipe'</span>).model().destroy();
    }
  },
  <span class="string">"{Cookbook.Models.Recipe} destroyed"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span> {</span>
    recipe.elements(<span class="keyword">this</span>.element).remove();
  },
  <span class="string">"{Cookbook.Models.Recipe} created"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span>{</span>
    <span class="keyword">this</span>.element.append(<span class="keyword">this</span>.view(<span class="string">'init'</span>, [recipe]))
  },
  <span class="string">"{Cookbook.Models.Recipe} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span>{</span>
      recipe.elements(<span class="keyword">this</span>.element)
          .html(<span class="keyword">this</span>.view(<span class="string">'recipe'</span>, recipe) );
  }
});
</code></pre>

<p>When the List control is added to the page, <code>init</code> is called:</p>

<pre><code class=" javascript"><span class="keyword">this</span>.element.html(<span class="keyword">this</span>.view(<span class="string">'init'</span>,Cookbook.Models.Recipe.findAll()) )
</code></pre>

<p>This beautiful one-liner does 4 things:</p>

<ul>
<li>Requests recipes from the server</li>
<li>Loads the <code>cookbook/recipe/list/views/init.ejs</code> template</li>
<li>When both recipes and the template have loaded, renders it</li>
<li>Inserts the result into the list element</li>
</ul>

<p><code>init.ejs</code> looks like:</p>

<pre><code class="html"><span class="vbscript">&lt;%for(var i = 0; i &lt; this.length ; i++){ %&gt;</span>
    <span class="tag">&lt;<span class="keyword">li</span> &lt;%=<span class="attribute"> this</span>[<span class="keyword">i</span>]%&gt;</span> &gt;
        <span class="vbscript">&lt;%== $.View('//cookbook/recipe/list/views/recipe.ejs', this[i] )%&gt;</span>
    <span class="tag">&lt;/<span class="keyword">li</span>&gt;</span>
<span class="vbscript">&lt;%}%&gt;</span></code></pre>

<p>This iterates through the recipes retrieved from the server.  For each
recipe, it creates an LI element and renders the <code>recipe.ejs</code>
sub-template.</p>

<p>Notice that the view 'adds' each recipe instance to its LI element with:</p>

<pre><code class="javascript">&lt;%= <span class="keyword">this</span>[i]%&gt;</code></pre>

<p>This adds the model to jQuery.data and sets a 'recipe' className on the 
LI element.  We'll make use of this in a moment.</p>

<p><strong>Destroying Recipes</strong></p>

<p>Each recipe has a destroy link.  When it is clicked on the list's
<code>'.destroy click'</code> method is called:</p>

<pre><code class=" javascript"><span class="keyword">if</span>(confirm(<span class="string">"Are you sure you want to destroy?"</span>)){
  el.closest(<span class="string">'.recipe'</span>).model().destroy();
}
</code></pre>

<p>This method checks if you want to destroy the method.  If you do,
it finds the parent 'recipe' element and gets back the model instance (that's
in jQuery.data).  It then calls <a href="#!jQuery.Model.prototype.destroy">model's destroy</a> method.</p>

<p>When a model is destroyed, it creates a <code>destroyed</code> event.  The List control 
listens to these events with:</p>

<pre><code class=" javascript"><span class="string">"{Cookbook.Models.Recipe} destroyed"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span> {</span>
  recipe.elements(<span class="keyword">this</span>.element).remove();
}
</code></pre>

<p>So, when a destroyed event happens, the List controller will look for [jQuery.fn.elements elements] that
have the recipe in jQuery.data and then remove them.</p>

<p><strong>Creating Recipes</strong></p>

<p>When a recipe is created, a "created" event is triggered.  The List control listens for this
with:</p>

<pre><code class=" javascript"><span class="string">"{Cookbook.Models.Recipe} created"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span>{</span>
  <span class="keyword">this</span>.element.append(<span class="keyword">this</span>.view(<span class="string">'init'</span>, [recipe]))
}
</code></pre>

<p>So, when a recipe is created, it will render the init view with the recipe and append the
result to the recipe element.</p>

<p><strong>Updating Recipes</strong></p>

<p>When a recipe is updated, an "updated" event is triggered. The List control listens for this
with:</p>

<pre><code class=" javascript"><span class="string">"{Cookbook.Models.Recipe} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">(Recipe, ev, recipe)</span>{</span>
  recipe.elements(<span class="keyword">this</span>.element)
        .html(<span class="keyword">this</span>.view(<span class="string">'recipe'</span>, recipe) );
}
</code></pre>

<p>So, when a recipe is updated, List will update that element's html.</p>

<h3>Putting it all Together</h3>

<p>The cookbook application loads both of these widgets and adds them to the page.
When Cookbook.Recipe.Create creates a Recipe, it creates a 'created' event which
Cookbook.Recipe.List listens for and adds that newly created recipe to its list
of recipes.</p>

<p>Continue to <a href="#!testing">Testing Cookbook</a>.</p></div>
			<div id="disqus_thread" style="display: none; "></div>
		</div>
	</div>
</div>
<div id="low">
	<a href="http://jupiterit.com">ï¿½ Jupiter Consulting - JavaScriptMVC Training and Support</a>
	<a class="api_links" href="http://javascriptmvc.com/docs/api.html#&amp;who=api"></a>
</div>
<script type="text/javascript">
	DOCS_SRC_MAP = {
		'funcunit' : 'https://github.com/jupiterjs/funcunit',
		'jquery' : 'https://github.com/jupiterjs/jquerymx',
		'steal' : 'https://github.com/jupiterjs/steal',
		'documentjs' : 'https://github.com/jupiterjs/documentjs'
	};
	DOCS_LOCATION = "docs/" //adds searchData to this
	JMVCDOC_TIMESTAMP = 264302280
	COMMENTS_LOCATION = 'http://jmvcs3.disqus.com/embed.js';
</script>
<script type="text/javascript" src="../steal/steal.js?documentjs/jmvcdoc">
</script>

<style type="text/css">
  body > iframe { width: 0;} 
  #dsq-content #dsq-form-area .dsq-attach-media-container iframe { height: 13px; padding: 0;}
</style>
	

</body>
</html>
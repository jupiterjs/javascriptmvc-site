<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
		"http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head><script type="text/javascript" src="http://localhost:5555?[]&amp;_=0.3523867295589298"></script>
	<title>PlayerMX</title>

	<link rel="shortcut icon" href="../documentjs/jmvcdoc/images/favicon.ico">
	<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxx-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<style type="text/css">.floatLeft {
  float: left;
}
/* content types */
body {
  font-family: sans-serif, "Trebuchet MS", Verdana, Helvetica, Arial;
  margin: 20px 0px 0px 0px;
  background: #fcfcfc;
  font-size: 17px;
}
h1 {
  position: relative;
  margin: 0;
}
h1 span.subtitle {
  color: #888888;
  font-style: italic;
}
h2 {
  border-bottom: solid 1px	#C3E2EF;
  padding-bottom: 3px;
}
h3 {
  color: #96A84A;
  font-size: 1.3em;
  margin-bottom: 10px;
}
h5 {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
pre {
  background-color: #F9F7DF;
  border: solid 1px white;
  margin: 13px 0;
  padding: 13px;
}
dl {
  margin: 10px;
}
td {
  padding: 3px;
  vertical-align: top;
}
.error {
  border: solid 1px red;
}
.error_text {
  color: red;
  font-size: 10px;
}
/* LAYOUT =========================*/
#documentation {
  width: 1024px;
  margin: 0px auto;
}
#top {
  margin: 0 20px 20px 20px;
  padding: 10px 0;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  background: #004634;
  background: -webkit-gradient(linear, left bottom, left top, color-stop(0, #004634), color-stop(1, #01654a));
  background: -ms-linear-gradient(bottom, #004634, #01654a);
  background: -moz-linear-gradient(center bottom, #004634 0%, #01654a 100%);
  background: -o-linear-gradient(bottom, #004634 0%, #01654a 100%);
  background: linear-gradient(bottom, #004634 0%, #01654a 100%);
  /*filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#01654a', endColorstr='#004634',GradientType=0 ); /* IE6-9 */

  -webkit-box-shadow: 0px 1px 0px #ffffff;
  -moz-box-shadow: 0px 1px 0px #ffffff;
  box-shadow: 0px 1px 0px #ffffff;
}
#top .content {
  /*height:34px;*/

  margin: 0 10px;
  overflow: auto;
}
#top #searchRoundCorners {
  float: left;
  width: 293px;
  height: 15px;
  padding: 0px;
  margin: 0px;
  zoom: 1;
  display: inline;
  padding-top: 5px;
}
#top #search {
  width: 273px;
  font-size: 14px;
  font-family: "Trebuchet MS", Verdana, Helvetica, Arial, sans-serif;
  float: left;
  border: none;
  background: #FFFFFF;
  outline: none;
  margin-left: 10px;
  position: absolute;
  margin: 0 0 0 10px;
  padding: 3px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  border: 1px solid #004634;
  -webkit-box-shadow: 0px 1px 0px #0f8563;
  -moz-box-shadow: 0px 1px 0px #0f8563;
  box-shadow: 0px 1px 0px #0f8563;
}
#top .logo-text a {
  color: white;
  float: right;
  left: -8px;
  position: relative;
  top: -4px;
  text-decoration: none;
  border: none;
}
#top .logo-image {
  left: 4px;
  position: relative;
  top: 8px;
  border: none;
}
/* TOP MENU STYLE ===== */
#defaults {
  float: left;
  font-weight: bold;
  width: 400px;
  margin-left: 10px;
  margin-bottom: 1px;
  height: 35px;
  line-height: 35px;
}
#defaults a {
  color: white;
  /*padding: 0px 10px;*/

  margin: 0 1px;
  text-decoration: none;
}
#defaults .ui-menu {
  height: 25px;
  line-height: 25px;
  margin: 7px 0px;
  padding: 0px;
  list-style-image: none;
  list-style-position: outside;
  list-style-type: none;
  position: absolute;
  z-index: 1000;
}
#defaults .ui-menu-item {
  float: left;
  /*padding:0.5em 1em;*/

  cursor: pointer;
}
#defaults .menuLink, #defaults .menuSpan {
  display: inline;
  height: 25px;
  float: left;
  cursor: pointer;
  font-size: 16px;
  text-shadow: 0px -1px #000000;
}
#defaults .menuSpan {
  padding-left: 10px;
  padding-right: 10px;
}
#defaults .menuLink:hover .menuSpan, #defaults .menuLink:hover span.red {
  background-color: #899d09;
  color: white;
  border-radius: 3px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  text-shadow: 0px 1px #333;
  -webkit-box-shadow: 0px 1px 0px #003f2f;
  -moz-box-shadow: 0px 1px 0px #003f2f;
  box-shadow: 0px 1px 0px #003f2f;
}
html*#searchRoundCorners {
  /* ie7 hack */

  padding: 7px;
}
.inside td {
  vertical-align: middle;
}
#bottom {
  margin: 0px 20px;
  clear: both;
}
#bottom p, #bottom ul, #bottom ol {
  color: #333;
  line-height: 24px;
}
#bottom a {
  color: #1f54c6;
}
#bottom p code {
  border: solid 1px #F9F7DF;
  white-space: nowrap;
  background-color: #eeeeee;
}
#bottom h2 code, #bottom h3 code {
  font-size: 17px;
  font-weight: normal;
  color: #333333;
  border: solid 1px #F9F7DF;
  background-color: #f9f9f9;
}
#nav {
  width: 300px;
  min-height: 10px;
  float: left;
  /*background-color: #2D2E26;*/
  /*#B8B495*/

  /*background-color:rgb(239,242,213);*/

  overflow: auto;
  margin-right: 20px;
  margin-bottom: 20px;
}
#nav a {
  display: block;
  padding: 5px;
  text-decoration: none;
  font-size: 14px;
  /*color: #F1F1C3;*/

  color: #404038;
  border: none;
  outline: none;
}
#nav #selected {
  margin: 0 0 10px 0;
}
#nav #selected .selected {
  font-size: 17px;
  font-weight: bold;
}
#nav #selected .spacer {
  height: 10px;
  background: #fcfcfc;
}
#nav #selected .content {
  margin: 0 0px;
  clear: both;
}
#nav #selected .content a {
  padding: 5px 10px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  background-color: #d2d988;
}
#nav #selected .content .highlight {
  background-color: #d7e1ad;
}
#nav #results {
  /*margin:10px 0 0 0;*/

  background-color: #e6f1ba;
  padding: 5px 0;
}
#nav #results .highlight {
  /*background-color: #3C3D32;*/

  background-color: #b6dceb;
}
#nav #results .open {
  /*the opened color*/

  background: #a0b348;
  color: white;
  font-weight: bold;
}
#nav .faded {
  color: gray;
}
#nav .prototype, #nav .static {
  color: gray;
}
#nav .class, #nav .constructor {
  font-weight: bold;
}
#nav .attribute {
  color: red;
}
#doc_container {
  margin-right: 0px;
  margin-left: 320px;
}
#doc {
  /*line-height:24px;*/

  /*padding: 0 20px 0 0;*/

  margin: 0;
}
#doc .type {
  color: gray;
  font-size: 0.8em;
}
#doc .content .type, #doc .typeEnd {
  text-shadow: none;
  display: inline-block;
  font-size: 0.7em;
  color: #FFFFFF;
  background: url("file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/type.png") no-repeat;
  background-position: 0 0;
  vertical-align: middle;
  margin-left: -9px;
  margin-bottom: 3px;
  *margin-bottom: 0px;
  /* ie7 */

}
#doc .typeEnd {
  display: block;
  line-height: 21px;
  background-position: 100% 0;
  margin-left: 11px;
  padding: 0 10px 0 5px;
  float: left;
}
#doc .top {
  margin: 0 0 20px;
  line-height: 38px;
  background-color: #c3e2ef;
  padding: 5px 0 1px 0;
  text-shadow: 0px 1px white;
  color: #222;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
}
#doc .top .content {
  margin: 5px 20px 5px 20px;
}
#doc .favorite {
  float: right;
  cursor: pointer;
  background-repeat: no-repeat;
  /*background-position: left 16px;*/

  /* ie7 hacks */

  *position: absolute;
  top: 5px;
  right: 0;
}
#doc .favoriteon {
  background-image: url(file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/fav-on.png);
}
#doc .favoriteoff {
  background-image: url(file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/fav-off.png);
}
#disqus_thread {
  margin: 0;
}
.remove {
  float: right;
  display: block;
  width: 16px;
  text-align: center;
  height: 16px;
  background-image: url('file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/documentjs/jmvcdoc/images/sidebar_top_close.png');
  margin: 1px -4px 0 0;
  opacity: 0.5;
}
.remove :hover {
  opacity: 1;
}
.jmvcdoc_search {
  position: relative;
}
.jmvcdoc_search .remove {
  display: none;
  position: absolute;
  top: 3px;
  right: 11px;
}
#low {
  font-size: 12px;
  margin: 10px auto;
  text-align: center;
  color: white;
  background: #e0e0e0;
  height: 30px;
  line-height: 30px;
  border-radius: 5px;
  -webkit-border-radius: 5px;
  -moz-border-radius: 5px;
  clear: both;
  width: 1024px;
}
#low a {
  color: #666;
  text-decoration: none;
  font-weight: bold;
}
/* CONTENT FORMATTING ============= */
.param, .return {
  text-indent: -48px;
  margin-left: 48px;
}
.param *, .return * {
  text-indent: 0px;
}
.param label, .return label {
  color: #808080;
  font-size: 10pt;
  font-weight: bold;
  margin: 0;
}
.options {
  margin-left: 40px;
  margin-right: 40px;
  text-align: left;
}
.options th {
  border-bottom: 1px solid #EEEEEE;
  font-family: "Helvetica Neue", Arial, sans-serif;
  font-size: 0.8em;
}
.options td {
  border-bottom: 1px solid #EEEEEE;
  font-size: 10pt;
  line-height: 150%;
  padding: 3px;
  vertical-align: top;
}
.signiture {
  border-color: #9C6854;
  background: none;
  background-color: white;
}
.params {
  margin-left: 13px;
}
code .comment {
  color: #007000;
}
.string {
  color: Gray;
}
.keyword {
  color: #800080;
}
code .params {
  color: blue;
  margin: 0px;
}
.magic {
  background-color: #FFF7D7;
}
.console {
  color: blue;
}
.this {
  color: #0000C0;
}
table pre {
  margin: 0px;
}
.floatLeft {
  float: left;
}
h2.spaced {
  clear: left;
  padding-top: 18px;
}
.warn {
  margin: 13px;
  padding: 13px;
  font-size: 11px;
  border: 1px solid #9C6854;
  background-color: #eeeeee;
}
.tip {
  font-size: 0.8em;
  font-family: verdana;
  padding-left: 13px;
}
.noborder {
  border: none;
}
.floatLeft .noborder {
  padding-right: 10px;
}
iframe {
  display: block;
  clear: right;
  width: 100%;
  border: 1px solid #cccccc;
  padding: 0 0 10px 10px;
  margin: 10px 0 10px 0;
  background-color: #eeeeee;
}
.iframe_wrapper {
  border: 1px solid #ffffff;
}
.iframe_menu_button {
  display: block;
  float: right;
  width: 100px;
  background-color: #cccccc;
  border-top: 1px solid #999999;
  border-left: 1px solid #999999;
  border-right: 1px solid #999999;
  cursor: pointer;
}
.iframe_menu {
  list-style-image: none;
  list-style-position: outside;
  list-style-type: none;
  font-size: 0.7em;
  background-color: #ffffff;
  border: 1px solid #999999;
  padding: 5px;
  margin: 0;
}
.iframe_menu_item {
  margin: 5px 2px 0px 2px;
}
/* @demo css
-------------*/
.demo .reset {
  padding: 0;
  margin: 0;
  border: 0;
  outline: 0;
  line-height: 1.3;
  text-decoration: none;
  font-size: 100%;
  list-style: none;
}
.demo .header a {
  font-family: "Trebuchet MS", Verdana, Helvetica, Arial, sans-serif;
  font-size: 12px;
  /*background-color: #AABF54;*/

  background-color: #D2D988;
  display: block;
  padding: .5em .5em .5em 2.2em;
  margin: 0;
  color: #FFFFFF;
  cursor: pointer;
  position: relative;
  margin-top: 1px;
  zoom: 1;
  /*border: 1px solid #AABF54;*/

  border: 1px solid #D2D988;
  text-decoration: none;
}
.demo .header .ui-icon {
  position: absolute;
  left: .5em;
  top: 50%;
  margin-top: -8px;
}
.demo .content {
  border: 1px solid #AABF54;
}
.demo .content iframe {
  padding: 0;
  margin: 0;
  background-color: #FFFFFF;
  border: none;
}
.demo pre {
  padding: 10px;
  margin: 0px;
  background-image: none;
}
.demo pre code {
  font-family: "Courier New";
  border: none;
}
.component {
  margin-right: 12px;
  height: 80px;
  float: left;
}
.whisper {
  color: #96A84A;
}
/* menu items */
iframe.pluginify {
  border: none;
  background: none;
  margin: 0px;
  height: 2060px;
  padding: 0px;
}
#tooltip {
  background-color: #b6dceb;
  height: 16px;
  padding: 5px;
  border-top: solid 5px white;
  border-bottom: solid 5px white;
  border-right: solid 5px white;
}
</style></head><body>
<div id="documentation">
	<div id="top">
		<div class="content">
			<div id="searchRoundCorners">
				<div class="jmvcdoc_search"><input id="search" type="input"><span title="clear term" class="remove"></span></div>
			</div>
			<div id="defaults">
				<ul id="menu" class="ui-menu">
					<li class="ui-menu-item">
						<a class="menuLink" href="#favorites"><span class="menuSpan">Favorites</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../follow.html" title="Follow"><span class="menuSpan red">Follow</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../contribute.html" title="Contribute"><span class="menuSpan red">Contribute</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../code.html" title="Code"><span class="menuSpan red">Code</span></a>
					</li>
				</ul>
			</div>
			<div class="logo-text"><a href="http://javascriptmvc.com"><img src="../documentjs/jmvcdoc/images/logo80x30.png" class="logo-image"></a></div>
		</div>
	</div>
	<div id="bottom">
		<div id="nav" class="jmvcdoc_nav">


	<div id="selected">
		    
				
		<div class="content">
			    <a href="#!" class="selected choice page" style="padding-left: 20px">
			    	
					JavaScriptMVC
					
				</a>
				
		</div>
			
				<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!examples" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Examples
					
				</a>
				
		</div>
			
			
	</div>

<div id="results" style="display: block">
	<div class="content">
	    
			
		    <a href="#!srchr" class="result choice page" style="padding-left: 20px" data-name="srchr">
		    	
					<span class="faded"></span>Srchr
				
			</a>
			
		
			
		    <a href="#!contacts" class="result choice page" style="padding-left: 20px" data-name="contacts">
		    	
					<span class="faded"></span>Contacts
				
			</a>
			
		
			
		    <a href="#!playermx" class="result choice page open" style="padding-left: 20px" data-name="playermx">
		    	
					<span class="faded"></span>PlayerMX
				
			</a>
			
		
			
		    <a href="#!todo" class="result choice page" style="padding-left: 20px" data-name="todo">
		    	
					<span class="faded"></span>Todo
				
			</a>
			
		
	</div>
</div>


</div>
		<div id="doc_container">
			<div id="doc" class="jmvcdoc_content">
<div class="top">
	<div class="content">
	    <h1>PlayerMX&nbsp;
	    	<span class="page type"><span class="typeEnd">page</span></span>&nbsp;
	    	<span class="favorite favoriteoff">&nbsp;&nbsp;&nbsp;</span></h1>
	    
	    
	    
		
		
		
	</div>	
</div>


<p>This article walks through a simple video player application utilizing Popcorn.js. We'll cover:</p>

<ul>
<li>Setting up the application</li>
<li>Templated events with <a href="#!mvc.controller">$.Controller</a></li>
<li>How PlayerMX is built</li>
</ul>

<h2>Setup</h2>

<p>There's two options to install PlayerMX: getjs or using git.</p>

<h3>Download with getjs</h3>

<p>After downloading and <a href="#!installing">installing JMVC</a>, run the following command:</p>

<p><code>./js steal/getjs player</code></p>

<p><em>Note: When running the getjs command, be sure to navigate to your <a href="#!rootfolder">JMVC root folder</a>.</em></p>

<h3>Github</h3>

<p>From a directory of your choice:</p>

<p><em>Clone files to your local drive</em> <br>
<code>$ git clone https://github.com/jupiterjs/playermx.git</code>  </p>

<p><em>Navigate to application directory and initialize submodules</em> <br>
<code>$ cd playermx <br>
$ git submodule update  --init</code></p>

<h3>Running</h3>

<p>Open player/player.html in your browser and see the application run:</p>

<p><img class="image_tag" src="file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/tutorials/images/playermx.png"></p>

<p><em>Note: Safari and Chrome currently support the mp4 codec, however Firefox requires the h.264 Flash player to process mp4's.</em></p>

<p>You can see our version running here: <a href="http://javascriptmvc.com/player/player.html">http://javascriptmvc.com/player/player.html</a></p>

<p>Repo: <a href="https://github.com/jupiterjs/playermx">https://github.com/jupiterjs/playermx</a></p>

<h2>PopcornJS Overview</h2>

<p>Repo: <a href="https://github.com/cadecairos/popcorn-js">https://github.com/cadecairos/popcorn-js</a></p>

<blockquote>
  <p><em>Popcorn.js is an event framework for HTML5 media. Popcorn.js utilizes the native HTMLMediaElement properties, methods and events, normalizes them into an easy to learn API and provides a plugin system for community contributed interactions.</em>  </p>
  
  <p><em><a href="http://popcornjs.org/documentation">Source: http://popcornjs.org/documentation</a></em></p>
</blockquote>

<p>Popcorn.js wraps up our mp4 file into a <code>video</code> object which we can pass to our widgets. Our widgets can then play and pause the video based on user interaction. The Popcorn.js API we'll be using is:</p>

<ul>
<li>Events:
<ul><li>play - triggered when video plays</li>
<li>pause - triggered when a video is paused</li>
<li>timeupdate - triggered continuously during video playback</li></ul></li>
<li>Properties:
<ul><li>paused - boolean, true if the video is paused</li></ul></li>
<li>Methods:
<ul><li>play() - begins playing video, triggers "play" event</li>
<li>pause() - pauses video, triggers "pause" event</li>
<li>currentTime() - gets the current playback position in milliseconds</li>
<li>duration() - gets length of the video in milliseconds</li></ul></li>
</ul>

<h2>Templated Events Overview</h2>

<p>PlayerMX introduces the concept of binding events to JavaScript objects other than DOM elements. This application uses the event syntax: <code>{myObject} click</code>, where <code>myObject</code> is the object and <code>click</code> is the event we're listening to. This is what we call templated events.</p>

<p>Templated events create a simple way to bind events without concern for cleanup. For example, binding an event to a DOM element with $.bind(), will be removed when you call $.remove() on that element. However, if you want to listen to events on a model, templated events handle the unbinding for you. In essence, memory concerns are reduced with templated events.</p>

<p>Specifically with PlayerMX, our widgets listen to events produced by our Popcorn video element. If that element is removed from our page, by using templated events, we don't need to worry about cleaning up bound methods.</p>

<h2>PlayerMX Architecture</h2>

<p>Once you've downloaded the application, you'll notice 3 folders within your <code>playermx</code> directory. A few notes on the directory structure of this application:</p>

<ul>
<li>The <code>jquery</code> folder refers to <a href="https://github.com/jupiterjs/jquerymx">jquerymx</a>. This is the JMVC core and what we'll be building our application on.</li>
<li>The <a href="https://github.com/jupiterjs/steal">steal</a> folder is our dependency management system. This is how we include other resources such as scripts, stylesheets, templates or other JMVC resources and apps altogether.</li>
<li>The <code>player</code> folder is where we'll place our focus as this is the main directory for our application.  </li>
</ul>

<p>The application is broken up into one main application page, <code>player.html</code>, with a corresponding script, <code>player.js</code> and two corresponding widgets.</p>

<p><img class="image_tag" src="file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/tutorials/images/playermx_overview.png"></p>

<h3>player.js</h3>

<p><code>Player.js</code> is our main application script. <code>Steal</code> loads the widgets we want, and then we initialize them. This loosely couples our widgets from our application. The variable <code>video</code> is our reference to the Popcorn.js wrapped object.  <code>play</code> and <code>player_position</code> accept this object as a parameter.</p>

<pre><code class=" javascript">steal(<span class="string">'./play.js'</span>,
  <span class="string">'./position.js'</span>,

  <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> video = Popcorn(<span class="string">"#trailer"</span>);

    $(<span class="string">'#play'</span>).play({ video: video });
    $(<span class="string">'#position'</span>).player_position({ video: video });
});
</code></pre>

<p>The first line of <code>player.js</code> is our call to <code>steal</code>. This is going to load all our dependencies. In this case, we load <code>play.js</code> and <code>position.js</code>, then execute a function.  </p>

<h3>play.js</h3>

<p><img class="image_tag" src="file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/tutorials/images/playermx_play.png"></p>

<pre><code class=" javascript">steal(<span class="string">'player/popcorn'</span>,
  <span class="string">'jquery/controller'</span>,

  <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
</code></pre>

<p>The purpose of this widget is to control the video playback. Listening to the <code>play</code> and <code>pause</code> events on the Popcorn.js object, we'll add a CSS class designating playback state.</p>

<p>Our widget will be created using <code>$.Controller</code>. By naming our controller "play", we have now have a <code>jQuery.fn.play()</code> method. <code>init</code> is the constructor method for our controller. Any passed parameters are accessible via <code>options</code> on the controller.</p>

<pre><code class=" javascript">    $.Controller(<span class="string">'Play'</span>, {
      init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="keyword">if</span>( <span class="keyword">this</span>.options.video.video.paused ) {
          <span class="keyword">this</span>.element.text(<span class="string">"play"</span>)
        } <span class="keyword">else</span> {
          <span class="keyword">this</span>.element.text(<span class="string">"stop"</span>)
        }
      },
</code></pre>

<p>Within player.js, we've passed a video object to our controller. Using templated events, we can listen to the events directly on this object. Templated events allow listening to events on any object, not just DOM events. In the code below, "{video}" refers to our object and "play" is the event we'll listen for.</p>

<pre><code class=" javascript">      <span class="string">"{video} play"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">this</span>.element.text(<span class="string">"stop"</span>).addClass(<span class="string">'stop'</span>)
      },

      <span class="string">"{video} pause"</span> : <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">this</span>.element.text(<span class="string">"play"</span>).removeClass(<span class="string">'stop'</span>)
      },
</code></pre>

<p>We'll listen to clicks within the parent element and call the play/pause methods, depending on current state. The separation of the click handler and the play/pause handlers is for extensibility. We may have multiple widgets that control the playback of our video and each widget should be able to respond accordingly.</p>

<pre><code class=" javascript">      click : <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">if</span>( <span class="keyword">this</span>.options.video.video.paused ) {
          <span class="keyword">this</span>.options.video.play()
        } <span class="keyword">else</span> {
          <span class="keyword">this</span>.options.video.pause()
        }
      }
  });
});
</code></pre>

<h3>position.js</h3>

<p><img class="image_tag" src="file:////Users/fred/Projects/jupiter/javascriptmvc-site/javascriptmvc/tutorials/images/playermx_position.png"></p>

<pre><code class=" javascript">steal(<span class="string">'player/popcorn'</span>,
  <span class="string">'jquery/controller'</span>,
  <span class="string">'jquery/dom/dimensions'</span>,
  <span class="string">'jquery/event/resize'</span>,
  <span class="string">'jquery/event/drag/limit'</span>,
</code></pre>

<p>The PlayerPosition widget shows a progression bar for our video. This should not only display playback position, but be draggable as well. <code>this</code> in the following context refers to our widget instance. Our progress indicator will be accessible via the <code>moving</code> property. A simple div will suffice for this example and we'll set some basic css properties such as position and dimensions.</p>

<pre><code class=" javascript">  <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    $.Controller(<span class="string">'PlayerPosition'</span>, {
      init : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="keyword">this</span>.moving = $(<span class="string">"&lt;div&gt;"</span>).css({
          position: <span class="string">'absolute'</span>,
          left: <span class="string">"0px"</span>
        })

        <span class="keyword">this</span>.element.css(<span class="string">"position"</span>,<span class="string">"relative"</span>)
          .append(<span class="keyword">this</span>.moving);

        <span class="keyword">this</span>.moving.outerWidth( <span class="keyword">this</span>.element.height() );
        <span class="keyword">this</span>.moving.outerHeight( <span class="keyword">this</span>.element.height() );

      },
</code></pre>

<p>The widget listens to the Popcorn.js <code>timeupdate</code> event on our video model to recalculate our indicator position. We've separated the event listener from the resize method to allow for any other widgets that may be listening to <code>timeupdate</code>.</p>

<pre><code class=" javascript">      <span class="string">"{video} timeupdate"</span> : <span class="function"><span class="keyword">function</span><span class="params">(video)</span>{</span>
        <span class="keyword">this</span>.resize()
      },
      resize : <span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="keyword">var</span> video = <span class="keyword">this</span>.options.video,
          percent = video.currentTime() / video.duration(),
          width = <span class="keyword">this</span>.element.width() - <span class="keyword">this</span>.moving.outerWidth();

        <span class="keyword">this</span>.moving.css(<span class="string">"left"</span>, percent*width+<span class="string">"px"</span>)
      },
</code></pre>

<p><em>Note: <code>draginit</code> and <code>dragend</code> are a couple of events provided by the JMVC framework. <a href="#!jQuery.Drag">jQuery.Drag</a></em>  </p>

<p>The drag events are scoped to the indicator div element. We can now call the Popcorn.js <code>play</code> and <code>pause</code> methods, trusting other widgets to respond as needed. In this app, these events will get picked up by our 'Play' widget to start/stop the playback.</p>

<pre><code class=" javascript">      <span class="string">"div draginit"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev, drag)</span>{</span>
        <span class="keyword">this</span>.options.video.pause()
        drag.limit(<span class="keyword">this</span>.element)
      },
      <span class="string">"div dragend"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev, drag)</span>{</span>
        <span class="keyword">var</span> video = <span class="keyword">this</span>.options.video,
          width = <span class="keyword">this</span>.element.width() - <span class="keyword">this</span>.moving.outerWidth()
          percent = parseInt(<span class="keyword">this</span>.moving.css(<span class="string">"left"</span>), <span class="number">10</span>) / width;

        video.currentTime(  percent * video.duration()  );
        video.play()
      }
    });
});
</code></pre>

<h2>Conclusion</h2>

<p>The secret to building large applications is to never build large applications.</p>

<p>Applications can quickly become overwhelming, complex and difficult to maintain. The takeaway from the PlayerMX architecture is to create isolated, dumb widgets that can be tied together with events. This article is an example of how to loosely couple your widgets, use templated events and integrate with an API (Popcorn.js).</p></div>
			<div id="disqus_thread" style="display: none; "></div>
		</div>
	</div>
</div>
<div id="low">
	<a href="http://jupiterit.com">ï¿½ Jupiter Consulting - JavaScriptMVC Training and Support</a>
	<a class="api_links" href="http://javascriptmvc.com/docs/api.html#&amp;who=api"></a>
</div>
<script type="text/javascript">
	DOCS_SRC_MAP = {
		'funcunit' : 'https://github.com/jupiterjs/funcunit',
		'jquery' : 'https://github.com/jupiterjs/jquerymx',
		'steal' : 'https://github.com/jupiterjs/steal',
		'documentjs' : 'https://github.com/jupiterjs/documentjs',
		mxui : 'https://github.com/jupiterjs/mxui'
	};
	DOCS_LOCATION = "docs/" //adds searchData to this
	JMVCDOC_TIMESTAMP = 265469885
	COMMENTS_LOCATION = 'http://jmvcs3.disqus.com/embed.js';
</script>
<script type="text/javascript" src="../steal/steal.js?documentjs/jmvcdoc">
</script>

<style type="text/css">
  body > iframe { width: 0;} 
  #dsq-content #dsq-form-area .dsq-attach-media-container iframe { height: 13px; padding: 0;}
</style>
	

</body>
</html>
<head><script type="text/javascript" src="http://localhost:5555?[]&amp;_=0.1129149324260652"></script>
	<title>Get Started with FuncUnit</title>
	<link rel="stylesheet" type="text/css" href="../documentjs/jmvcdoc/style.css">
	<link rel="shortcut icon" href="../documentjs/jmvcdoc/images/favicon.ico">
	<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxx-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link rel="stylesheet" href="file:////Users/bmoschel/tools/workspace/javascriptmvc/documentjs/jmvcdoc/style.css" type="text/css"><script src="http://jmvcs3.disqus.com/thread.js?url=file:////Users/bmoschel/tools/workspace/javascriptmvc/jmvc/docs.html?steal%5Bbrowser%5D=phantomjs&steal%5BstartFiles%5D=steal/browser/phantomjs/client.js#!jQuery.Controller&amp;title=&amp;sort=&amp;per_page&amp;category_id=&amp;developer=0&amp;identifier=#!jQuery.Controller&amp;disqus_version=1318875915&amp;1318970164014" charset="UTF-8"></script><link rel="stylesheet" type="text/css" href="http://mediacdn.disqus.com/1318875915/build/system//defaults.css"><script src="http://mediacdn.disqus.com/1318875915/build/system/disqus.js?" charset="UTF-8"></script></head><body>
<div id="documentation">
	<div id="top">
		<div class="topCorner">
			<div class="right"></div>
			<div class="left"></div>
		</div>
		<div class="content">
			<div id="searchRoundCorners">
				<div class="jmvcdoc_search"><input id="search" type="input"><span title="clear term" class="remove"></span></div>
			</div>
			<div id="defaults">
				<ul id="menu" class="ui-menu">
					<li class="ui-menu-item">
						<a class="menuLink" href="#favorites"><span class="menuSpan">Favorites</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../follow.html" title="Follow"><span class="menuSpan red">Follow</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../contribute.html" title="Contribute"><span class="menuSpan red">Contribute</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../code.html" title="Code"><span class="menuSpan red">Code</span></a>
					</li>
				</ul>
			</div>
			<div class="logo-text"><a href="http://javascriptmvc.com"><img src="../documentjs/jmvcdoc/images/logo80x30.png" class="logo-image"></a></div>
		</div>
		<div class="bottomCorner">
			<div>&nbsp;</div>
		</div>
	</div>
	<div id="bottom">
		<div id="nav" class="jmvcdoc_nav">


	<div id="selected">
		    
				
		<div class="content">
			    <a href="#!" class="selected choice page" style="padding-left: 20px">
			    	
					JavaScriptMVC
					
				</a>
				
		</div>
			
		<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!tutorials" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Tutorials
					
				</a>
				
		</div>
			
			
	</div>

<div id="results" style="display: block">
	<div class="content">
	    
			
		    <a href="#!installing" class="result choice page" style="padding-left: 20px">
		    	Installing JavaScriptMVC
			</a>
			
		
			
		    <a href="#!getstarted" class="result choice page" style="padding-left: 20px">
		    	Get Started with JavaScriptMVC
			</a>
			
		
			
		    <a href="#!mvc" class="result choice page" style="padding-left: 20px">
		    	Get Started with jQueryMX
			</a>
			
		
			
		    <a href="#!tutorials.steal" class="result choice page" style="padding-left: 20px">
		    	Get Started With StealJS
			</a>
			
		
			
		    <a href="#!funcunit.getstarted" class="result choice page open" style="padding-left: 20px">
		    	Get Started with FuncUnit
			</a>
			
		
			
		    <a href="#!organizing" class="result choice page" style="padding-left: 20px">
		    	Organizing Your App
			</a>
			
		
			
		    <a href="#!ajaxy" class="result choice page" style="padding-left: 20px">
		    	Searchable Ajax Apps
			</a>
			
		
			
		    <a href="#!services" class="result choice page" style="padding-left: 20px">
		    	Ajax Service Guidelines
			</a>
			
		
			
		    <a href="#!migrate" class="result choice page" style="padding-left: 20px">
		    	Upgrading to 3.2
			</a>
			
		
	</div>
</div>


</div>
		<div id="doc_container">
			<div id="doc" class="jmvcdoc_content">
<div class="top">
	<div class="content">
	    <h1>Get Started with FuncUnit&nbsp;
	    	<span class="page type"><span class="typeEnd">page</span></span>&nbsp;
	    	<span class="favorite favoriteoff">&nbsp;&nbsp;&nbsp;</span></h1>
	    
	    
	    
		
		
	</div>	
</div>


<p>In this guide, we'll use <a href="#!FuncUnit">FuncUnit</a> to write functional tests for the jQuery UI 
autocomplete widget. We'll go over:</p>

<ul>
<li>Running a test in browser</li>
<li>Writing a test</li>
<li>Debugging a broken test</li>
<li>Running tests via Selenium</li>
<li>Running tests via PhantomJS</li>
</ul>

<h2>Running Autocomplete Tests</h2>

<p>Open <em>funcunit/test/autosuggest/autosuggest.html</em> in a browser.  Type "J" in the input.  You'll see the following:</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/funcunit/pages/images/autosuggest.png"></p>

<p>This page is a simple demo app, using jQueryUI <a href="http://jqueryui.com/demos/autocomplete/">autocomplete</a>. It 
shows results when you start typing, then you can click a result (or use mouse navigation) to populate the input.</p>

<p>There is a test already written.  Open <i>funcunit/test/autosuggest/autosuggest_test.js</i> in your IDE:</p>

<pre><code class="javascript">module(<span class="string">"autosuggest"</span>,{
  setup: <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    S.open(<span class="string">'autosuggest.html'</span>)
  }
});

test(<span class="string">"results appear"</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  S(<span class="string">'input'</span>).visible().click().type(<span class="string">"Java"</span>)

  <span class="comment">// wait until we have some results</span>
  S(<span class="string">'.ui-menu-item'</span>).visible(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    equal( S(<span class="string">'.ui-menu-item'</span>).size(), <span class="number">2</span>, <span class="string">"there are 2 results"</span>)
  })
});</code></pre>

<p>As you can probably tell, the [s S method] is an alias for jQuery (*).  This test:</p>

<ol>
<li>Opens autosuggest.html</li>
<li>Grabs the input element, clicks it, and types "Java"</li>
<li>Grabs the element that is populated with results, waits for it to be visible</li>
<li>Asserts that there are 2 results shown</li>
</ol>

<p>(*) Actually its a <a href="http://api.jquery.com/jQuery.sub/">copy</a> of jQuery that performs queries in 
the application window by default, and sometimes caches its selector to run asynchronously.</p>

<p>To run this test, open <i>funcunit/test/autosuggest/funcunit.html</i> in any browser (turn off your popup blocker).  The test will open and run.  The results are shown in the QUnit page:</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/funcunit/pages/images/qunit.png"></p>

<h2>Writing an Autocomplete Test</h2>

<p>Next we'll add a test for selecting a result with the keyboard.  FuncUnit's [apifuncunit API] consists of:</p>

<ul>
<li><a href="#!funcunit.finding">The S Method</a> - Perform a query in the application window</li>
<li><a href="#!funcunit.actions">Actions</a> - Simulate user actions like <a href="#!FuncUnit.prototype.click">click</a>,  <a href="#!FuncUnit.prototype.type">type</a>,  <a href="#!FuncUnit.prototype.drag">drag</a></li>
<li><a href="#!funcunit.waits">Waits</a> - Wait for a condition in your page to be met.  Fail the test if the condition isn't met before a timeout.</li>
<li><a href="#!funcunit.getters">Assertions &amp; getters</a> - Synchronously check a condition in your page.</li>
</ul>

<p>The setup and assertion methods are part of the <a href="http://docs.jquery.com/Qunit">QUnit</a> API.</p>

<p>Our test should do the following:</p>

<ol>
<li>Type "JavaS" in the input.</li>
<li>Wait for a result to be visible.</li>
<li>Select the input and press the down and enter keys to select the first item.</li>
<li>Wait for the input to show "JavaScript".</li>
</ol>

<p>Add the following under the first test:</p>

<pre><code class="javascript">test(<span class="string">"keyboard navigation"</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  S(<span class="string">'input'</span>).visible().click().type(<span class="string">"JavaS"</span>)

  S(<span class="string">'.ui-menu-item'</span>).visible()
  S(<span class="string">'input'</span>).type(<span class="string">'[down][enter]'</span>)
    .val(<span class="string">"JavaScript"</span>)
});</code></pre>

<p>A few important notes about this test:</p>

<ol>
<li>We have no assertions. This is ok. Most FuncUnit tests don't need them. If the wait conditions aren't met before a timeout, the test will fail.  If the test completes, this feature is working.</li>
<li>The click, visible, and val methods are actually doing asynchronous things. FuncUnit lets you write tests with this linear syntax by queueing the actual methods and running them one by one. This is to prevent your tests from being an unreadable mess of nested functions like:</li>
</ol>

<pre><code class="javascript">S(<span class="string">'.input'</span>).visible(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
  S(<span class="string">'.input'</span>).click(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    S(<span class="string">'input'</span>).type(<span class="string">"JavaS"</span>)
  })
})</code></pre>

<p>Reload the funcunit.html page and see your new test run and pass.</p>

<h2>Debugging tests</h2>

<p>Now change .val("JavaScript") to .text("C#").  Reload the page and watch it timeout and fail.</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/funcunit/pages/images/broken.png"></p>

<p>In this case, the error message shown is a good indication for why the test is broken. But often we need 
more visibility to debug a test.</p>

<p>Your first debugging instinct might be "Let's add a breakpoint!".  But, as noted, this 
code is running asynchronously.  When .val() runs, its adding a method to 
FuncUnit.queue, not actually doing the check.  When its this wait condition's turn to 
run, $("input").val() === "JavaScript" is checked repeatedly until its true or a timeout is reached.  </p>

<p>We can replace the string value with a checker function and use console.log to see what's going on. When 
previous queued methods finish, this function will run on repeat. Change that line to:</p>

<pre><code class="javascript">  .val(<span class="function"><span class="keyword">function</span><span class="params">(val)</span>{</span>
    console.log(val, <span class="keyword">this</span>)
    <span class="keyword">if</span>(val === <span class="string">"C#"</span>) <span class="keyword">return</span> <span class="literal">true</span>;
  });</code></pre>

<p>"this" in your wait method is the element that .text is being run against. The console will show the following:</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/funcunit/pages/images/console.png"></p>

<p>Using this technique, you can inspect the state of your app at various points throughout the test. Undo 
this breaking change before moving on to the next part.</p>

<h2>Running in Selenium</h2>

<p>Next we'll run this same test via the browser automation tool Selenium. Open a 
command prompt to the JMVC directory and run the following:</p>

<pre><code class="javascript">.<span class="regexp">/js funcunit/</span>run selenium funcunit/test/autosuggest/funcunit.html</code></pre>

<p>On windows, just use "js" instead of ./js. This will open the test page in 
Firefox, run the same test, and report the results on the command line:</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/funcunit/pages/images/commandline.png"></p>

<p>You can configure this step to run in any browser via the [integrations settings.js file].</p>

<h2>Running in PhantomJS</h2>

<p>Running in Selenium is great, but physically opening a browser can be too slow for quick 
regression testing.  <a href="http://www.phantomjs.org/">PhantomJS</a> is a headless version of WebKit, which can run the same 
tests from the commandline much faster without opening any visual browser windows. To run 
this step, first you must <a href="#!funcunit.phantomjs">PhantomJS</a>. Then run:</p>

<pre><code class="javascript">.<span class="regexp">/js funcunit/</span>run phantomjs funcunit/test/autosuggest/funcunit.html</code></pre>

<p>Phantom opens your page, runs the same test, and reports results on the commandline. 
This step can be easily integrated in your build process via <a href="#!funcunit.jenkins">Jenkins</a> or <a href="#!funcunit.maven">Maven</a>.</p>

<h2>Conclusion</h2>

<p>Hopefully, this guide illustrates how FuncUnit provides the holy grail of testing: easy, familiar syntax, in browser running for 
easy debugging, and simple automation.  </p>

<p>FuncUnit will transform your development lifecycle, give your developers confidence, and improve quality.</p>

<p>That's it! If you want to learn more, read about FuncUnit's <a href="#!FuncUnit">API</a> and <a href="#!funcunit.integrations">integrations</a> 
or check out some <a href="#!funcunit.demos">demos</a>.</p></div>
			<div id="disqus_thread"><div id="dsq-content-stub"><img width="71" height="17" alt="DISQUS" src="data:image/png;base64,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"><img width="16" height="11" alt="..." src="data:image/gif;base64,R0lGODlhEAALAPQAAP///z2LqeLt8dvp7u7090GNqz2LqV+fuJ/F1IW2ycrf51aatHWswaXJ14i4ys3h6FmctUCMqniuw+vz9eHs8fb5+meku+Tu8vT4+cfd5bbT3tbm7PH2+AAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA" style="margin:0 0 3px 5px"></div><div id="dsq-content" style="display: none; "></div></div>
      <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
		</div>
	</div>
</div>
<div id="low">
	<a href="http://jupiterit.com">ï¿½ Jupiter Consulting - JavaScriptMVC Training and Support</a>
	<a class="api_links" href="http://javascriptmvc.com/docs/api.html#&amp;who=api"></a>
</div>
<script type="text/javascript">
	DOCS_LOCATION = "docs/" //adds searchData to this
	JMVCDOC_TIMESTAMP = 263793756
</script>
<script type="text/javascript" src="../steal/steal.js?documentjs/jmvcdoc">
</script>
<script type="text/javascript">
  window.disqus_identifier = window.location.hash;
  window.disqus_url = window.location.toString();
  steal('jquery/dom/route', 'http://jmvcs3.disqus.com/embed.js').then(function(){
    $.route.delegate('who', 'change', function(ev, attr, how, newVal, oldVal) {
		if (window.location.protocol !== "file:") { // avoid this for crawl script
			  DISQUS.reset({
			    reload: true,
			    config: function () {  
			      this.page.identifier = window.location.hash;  
			      this.page.url = window.location.toString();
			    }
			  });
	     }
    })
  });
</script>
<style type="text/css">
  body > iframe { width: 0;} 
  #dsq-content #dsq-form-area .dsq-attach-media-container iframe { height: 13px; padding: 0;}
</style>
	

</body>
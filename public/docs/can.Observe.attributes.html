<!DOCTYPE html>

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>JavaScriptMVC - attributes </title>
	<meta name="description" content="">
	<meta name="author" content="">

	<link rel="stylesheet" type="text/css" 
		
			href="./static/production.css"
		 />
	<!--[if lt IE 9]>
   <script type="text/javascript" src="./static/html5shiv.js"></script>
    <!--<![endif]-->
</head>

<body class="docs">
	<header>
		<nav class="container">

			<div class="logo-menu">
				<a class="brand canjs" href="./index.html">JavaScriptMVC</a>
				<ul class="dropdown-menu">
					<li><a href="http://javascriptmvc.com">JavaScriptMVC</a></li>
					<li class="active"><a href="./index.html">CanJS</a></li>
					<li><a href="http://jquerypp.com">jQuery++</a></li>
					<li><a href="http://javascriptmvc.com/docs/stealjs.html">StealJS</a></li>
					<li><a href="http://javascriptmvc.com/docs/FuncUnit.html">FuncUnit</a></li>
					<li><a href="http://javascriptmvc.com/docs/DocumentJS.html">DocumentJS</a></li>
				</ul>
			</div>
			<ul class="nav">
				<li><a href="/index.html">Home</a></li>
				<li class="active"><a href="/docs/index.html">Docs</a></li>
				<li><a href="http://forum.javascriptmvc.com">Forums</a></li>
				<li><a href="http://github.com/bitovi/javascriptmvc">Code</a></li>
				<li><a href="http://twitter.com/javascriptmvc">Twitter</a></li>
				<li><a href="/dist/javascriptmvc-3.3.zip">Download</a></li>
			</ul>
			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="http://bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="http://bitovi.com">Bitovi.com</a></li>
						<li><a href="http://bitovi.com/blog/">Blog</a></li>
						<li><a href="http://bitovi.com/consulting/">Consulting</a></li>
						<li><a href="http://bitovi.com/training/">Training</a></li>
						<li><a href="http://bitovi.com/open-source/">Open Source</a></li>
						<li><a href="http://bitovi.com/people/">People</a></li>
						<li><a href="http://bitovi.com/contact/">Contact Us</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>

	<div class="container api">
	<nav class="sidebar">
		
		<div class="search-wrapper">
			<div class="search">
				<input type="text"/>
			</div>
		</div>
		
		<ul class="api cascading primary-grouping"> 
	
		
		<li class="search-container active parent">
			<a href="index.html" data-search="JavaScriptMVC">
				JavaScriptMVC
			</a>
		</li>
		
		<li class="search-container active parent">
			<a href="canjs.html" data-search="CanJS">
				CanJS
			</a>
		</li>
		
		<li class="search-container active parent">
			<a href="can.Observe.html" data-search="can.Observe">
				can.Observe
			</a>
		</li>
		
		
			<li class="search-container active">
			<a href="can.Observe.attributes.html" data-search="attributes">
				attributes
			</a>
			
	<ul>
		
			
		
			
		
			
				
					
					<li class="heading search-container">
						<span>prototype</span>
						
	<ul>
		
			
				
				
				<li class="search-container">
					<a class="function" href="can.Observe.prototype.attributes.serialize.html" data-search="serialize">
						serialize
					</a>
				</li>
				
			
			
		
	</ul>


					</li>
					
				
				
			
			
		
			
				
					
					<li class="heading search-container">
						<span>static</span>
						
	<ul>
		
			
				
				
				<li class="search-container">
					<a class="property" href="can.Observe.attributes.static.attributes.html" data-search="attributes">
						attributes
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="property" href="can.Observe.attributes.static.convert.html" data-search="convert">
						convert
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="property" href="can.Observe.attributes.static.serialize.html" data-search="serialize">
						serialize
					</a>
				</li>
				
			
			
		
	</ul>


					</li>
					
				
				
			
			
		
	</ul>


		</li>
		
	
</ul>

	</nav>
	<article class="content docs">
		<section class="title">
			<div class="pull-right">
	<ul class="tags">
		<li>page</li>
	</ul>
	<ul class="links">
		
			<li><a href="">source</a></li>
		
		
			<li><a href="">download</a></li>
		
		
			<li><a href="">tests</a></li>
		
	</ul>
</div>

<h1>
attributes

	

<span class="module">can/observe/attributes</span>
</h1>

<span class="inherits">&nbsp;</span>

		</section>

		<section class="contents">
		</section>

		<section class="description">
			
		</section>

		

		

		
		<section class="comment">
			<p>can.Observe.attributes is a plugin that helps convert and normalize data being set on an Observe
and allows you to specify the way complex types get serialized. The attributes plugin is most
helpful when used with <a href="can.Model.html">can.Model</a> (because the serialization aids in sending data to a server),
but you can use it with any Observe you plan to make instances
from.</p>

<p>There are three important static properties to give the class you want to use attributes with:</p>

<ul>
<li><code><a href="can.Observe.attributes.static.attributes.html">attributes</a></code> lists the properties that will be normalized
and the types those properties should be.</li>
<li><code><a href="can.Observe.attributes.static.convert.html">convert</a></code> lists how to convert and normalize arbitrary values
to the types this class uses.</li>
<li><code><a href="can.Observe.attributes.static.serialize.html">serialize</a></code> lists serialization algorithms for the types
this class uses.</li>
</ul>

<p>Together, the functions in <em>convert</em> and <em>serialize</em> make up the type definitions for the class.
The attributes plugin comes with three useful predefined types: <code>'date'</code>, <code>'number'</code>, and <code>'boolean'</code>.</p>

<p>Here is a quick example of an Observe-based class using the attributes plugin to convert and normalize
its data, and then to serialize the instance:</p>

<pre><code class="lang-javascript">can.Observe('Bio', {
    attributes: {
        birthday: 'date',
        weight: 'number'
    }
    // Bio only uses built-in types, so no
    // need to specify serialize or convert.
}, {});

var alice = new Bio({
    birthday: Date.parse('1985-04-01'), // 481161600000
    weight: '120'
});

alice.attr();      // { birthday: Date(481161600000), weight: 120 }
alice.serialize(); // { birthday: 481161600000, weight: 120 }
</code></pre>

<h3>Demo</h3>

<p>When a user enters a new date in the format of <em>YYYY-MM-DD</em>, the control 
listens for changes in the input box and updates the Observable using 
the <code>attr</code> method which then converts the string into a JavaScript date object.  </p>

<p>Additionally, the control also listens for changes on the Observable and 
updates the age in the page for the new birthdate of the contact.</p>

<div class='demo_wrapper' data-demo-src='can/observe/attributes/attributes.html'></div>

<h3>Reference types</h3>

<p>Types listed in <code>attributes</code> can also be a functions, such as the <code>model</code> or
<code>models</code> methods of a <a href="can.Model.html">can.Model</a>. When data of this kind of type is set, this
function is used to convert the raw data into an instance of the Model.</p>

<p>This example builds on the previous one to demonstrate these reference types.</p>

<p>can.Observe('Bio', {
    attributes: {
        birthday: 'date',
        weight: 'number'
    }
    // Contact only uses built-in types, so you don't have
    // to specify serialize or convert.
}, {});</p>

<p>can.Observe('Contact', {
  attributes: {
    bio: 'Bio.newInstance'
  }
}, {});</p>

<p>var alice = new Contact({
  first: 'Alice',
  last: 'Liddell',
  bio: {
    birthday: Date.parse('1985-04-01'), // 481161600000
    weight: 120
  }
});</p>

<p>The Attributes plugin provides functionality for converting data attributes from raw types and 
serializing complex types for the server.</p>

<p>Below is an example code of an Observe providing serialization and conversion for dates and numbers.  </p>

<p>When <code>Contact</code> is initialized, the <code>weight</code> attribute is set and converted to a <code>number</code> using the
converter we provided.  Next the <code>birthday</code> attribute is set using the <code>attr</code> method and gets converted
as well.  Lastly, <code>serialize</code> is invoked converting the new attributes to raw types for the server.</p>

<pre><code>var Contact = new can.Observe({
    attributes: {
        birthday: 'date'
        weight: 'number'
    },
    serialize : {
        date : function( val, type ){
            // returns the string formatted as 'YYYY-DD-MM'
            return val.getYear() + 
                    "-" + (val.getMonth() + 1) + 
                    "-" + val.getDate(); 
        },
        number: (val){
            return val + '';
        }
    },
    convert: {
        // converts string to date
        date: function( date ) {
            if ( typeof date == 'string' ) {
                //- Extracts dates formated 'YYYY-DD-MM'
                var matches = raw.match( /(\d+)-(\d+)-(\d+)/ ); 

                //- Parses to date object and returns
                date = new Date( matches[ 1 ],
                        ( +matches[ 2 ] ) - 1, 
                        matches[ 3 ] ); 
            }

            return date;
        },

        // converts string to number
        number: function(number){
            if(typeof number === 'string'){
                number = parseInt(number);
            }
            return number;
        }
    }
}, {});

var brian = new Contact({
    weight: '300'
});

var weight = brian.attr('weight'); //-&gt; 300

//- sets brian's birthday
brian.attr('birthday', '11-29-1983');

var date = brian.attr('birthday'); //-&gt; Date()

var seralizedObj = brian.serialize();
//-&gt; { 'birthday': '11-29-1983', 'weight': '300' }
</code></pre>

<h2>Associations</h2>

<p>Attribute type values can also represent the name of a function. The most common case this is used is for associated data.</p>

<p>For example, a <code>Deliverable</code> might have many tasks and an owner (which is a Person). The attributes property might look like:</p>

<pre><code>var Deliverable = new can.Observe({
    attributes : {
        tasks : "App.Models.Task.models"
        owner: "App.Models.Person.model"
    }
});
</code></pre>

<p>This points tasks and owner properties to use <em>Task</em> and <em>Person</em> to convert the raw data into an array of Tasks and a Person.</p>

<p>Its important to note that the full names of the models themselves are <em>App.Models.Task</em> and <em>App.Models.Person</em>. The <code>.model</code> 
and <code>.models</code> parts are appended for the benefit of convert to identify the types as models.</p>

<h3>Demo</h3>

<p>Below is a demo that showcases associations between 2 different models to show the tasks
for each contact and how much time they have left to complete the task(s) using converters.</p>

<div class='demo_wrapper' data-demo-src='can/observe/attributes/attributes-assocations.html'></div>
		</section>
		

		
	</article>
</div>



	<footer>
		<nav class="container">
			<a class="brand javascriptmvc" href="index.html"></a>
		</nav>
	</footer>
	<script type="text/javascript">
		window.Bitovi = {
			URL: {
				BUILDER: '',
				BUILDER_DATA: '',
				BITHUB: '',
				CDN: ''
			}
		}
		steal = {
			productionId: "production.js",
			executed: ["documentjs/site/static/build/production.css"]
		}
	</script>
	<p></p>
	<script 
	
		src="./static/steal.production.js"
	
		></script>
</body>

</html>
